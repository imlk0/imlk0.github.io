<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>CodeForces 697D æ ‘+æ¦‚ç‡ | imlk's blog</title>
<link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel=stylesheet></head><body><header class=header><a class=logo href=/>imlk's Blog</a><nav><ul class=menu><li><a href=/>ğŸ Home</a></li><li><a href=/about/>ğŸ‘‹About</a></li><li><a href=/archives/>ğŸ“œArchives</a></li><li><a href=/friends/>ğŸ”—Friends</a></li><li><a href=/dn42/>ğŸ•¸ï¸DN42</a></li><li><a href=/index.xml>ğŸ“¢Subscribe</a></li></ul></nav></header><hr><div class=article-meta><h1><span class=title>CodeForces 697D æ ‘+æ¦‚ç‡</span></h1><span><span class=date>ğŸ“… 2018-02-01</span>
<span class=date>(æ›´æ–°äº2021-10-10)</span>
/
<span class=cats>ğŸ“š
<a href=https://blog.imlk.top/categories/algorithm/>Algorithm</a>
</span>/
<span class=tags>ğŸ·ï¸
<a href=https://blog.imlk.top/tags/codeforces/>#Codeforces</a>
<a href=https://blog.imlk.top/tags/tree/>#Tree</a></span></span><br></div><main class=post-content><p><a href=http://codeforces.com/problemset/problem/697/D>åŸé¢˜é“¾æ¥</a></p><pre tabindex=0><code>D. Puzzles
time limit per test
1 second
memory limit per test
256 megabytes
input
standard input
output
standard output

Barney lives in country USC (United States of Charzeh). USC has n cities numbered from 1 through n and nâ€‰-â€‰1 roads between them. Cities and roads of USC form a rooted tree (Barney&#39;s not sure why it is rooted). Root of the tree is the city number 1\. Thus if one will start his journey from city 1, he can visit any city he wants by following roads.

Some girl has stolen Barney&#39;s heart, and Barney wants to find her. He starts looking for in the root of the tree and (since he is Barney Stinson not a random guy), he uses a random DFS to search in the cities. A pseudo code of this algorithm is as follows:

let starting_time be an array of length n
current_time = 0
dfs(v):
	current_time = current_time + 1
	starting_time[v] = current_time
	shuffle children[v] randomly (each permutation with equal possibility)
	// children[v] is vector of children cities of city v
	for u in children[v]:
		dfs(u)

As told before, Barney will start his journey in the root of the tree (equivalent to call dfs(1)).

Now Barney needs to pack a backpack and so he wants to know more about his upcoming journey: for every city i, Barney wants to know the expected value of starting_time[i]. He&#39;s a friend of Jon Snow and knows nothing, that&#39;s why he asked for your help.
Input

The first line of input contains a single integer n (1â€‰â‰¤â€‰nâ€‰â‰¤â€‰105) â€” the number of cities in USC.

The second line contains nâ€‰-â€‰1 integers p2,â€‰p3,â€‰...,â€‰pn (1â€‰â‰¤â€‰piâ€‰&lt;â€‰i), where pi is the number of the parent city of city number i in the tree, meaning there is a road between cities numbered pi and i in USC.
Output

In the first and only line of output print n numbers, where i-th number is the expected value of starting_time[i].

Your answer for each city will be considered correct if its absolute or relative error does not exceed 10â€‰-â€‰6.
Examples
Input

7
1 2 1 1 4 4

Output

1.0 4.0 5.0 3.5 4.5 5.0 5.0 

Input

12
1 1 2 2 4 4 3 3 1 10 8

Output

1.0 5.0 5.5 6.5 7.5 8.0 8.0 7.0 7.5 6.5 7.5 8.0 
</code></pre><pre tabindex=0><code>#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;set&gt;
//multisetçš„å®šä¹‰åœ¨setå¤´æ–‡ä»¶ä¸­

using namespace std;

int data[100005][2];//[0]è‡ªèº«ä»¥åŠå­èŠ‚ç‚¹çš„æ•°é‡[1]çˆ¶èŠ‚ç‚¹
double ans[100005];

struct Node {
	int x;//çˆ¶èŠ‚ç‚¹
	int y;//å­èŠ‚ç‚¹

	Node(int x, int y): x(x), y(y) {
	}
	int operator &lt; (Node const &amp; n) const {//å€’åº
		return x &gt; n.x;
	}
};

multiset&lt;Node&gt; ms;

int main(int argc, char const *argv[])
{

	int n, temp;
	scanf(&#34;%d&#34;, &amp;n);
	data[1][0] = 1;
	for (int i = 2; i &lt;= n; i++) {
		scanf(&#34;%d&#34;, &amp;temp);
		data[i][0] = 1;
		data[i][1] = temp;
		Node n(temp, i);
		ms.insert(n);
	}

	// ä»æ ‘çš„æœ€åº•å¼€å§‹ä¸Šå‡
	int cou = 0;
	for (multiset&lt;Node&gt;::iterator i = ms.begin(); i != ms.end(); ++i) {
		data[i-&gt;x][0] += data[i-&gt;y][0];
	}

	ans[1] = 1.0;
	printf(&#34;1.0&#34;);
	for (int i = 2; i &lt;= n; i++) {
		/**
		* ç¬¬iä¸ªèŠ‚ç‚¹çš„æœŸæœ› == å®ƒçš„çˆ¶èŠ‚ç‚¹çš„æœŸæœ› + åœ¨å®ƒè‡ªèº«çš„è€—æ—¶(1) + ç¬¬iä¸ªèŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹åŠå®ƒæ‹“å±•çš„å­èŠ‚ç‚¹è€—æ—¶çš„æœŸæœ›(å³å…„å¼ŸèŠ‚ç‚¹åŠå®ƒæ‹“å±•çš„å­èŠ‚ç‚¹æ•° * 0.5)
		* (å…„å¼ŸèŠ‚ç‚¹åŠå®ƒæ‹“å±•çš„å­èŠ‚ç‚¹æ•° == i çš„çˆ¶èŠ‚ç‚¹ - i èŠ‚ç‚¹æ‹“å±•çš„æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹(åŒ…æ‹¬i) - 1(çˆ¶èŠ‚ç‚¹è‡ªèº«))ï¼Œ
		* è¿™äº›èŠ‚ç‚¹æ¯ä¸€ä¸ªè¦ä¹ˆåœ¨iä¹‹å‰è¢«éå†ï¼Œè¦ä¹ˆåœ¨iä¹‹åï¼Œäºæ˜¯æœŸæœ›å€¼ä¹˜ä»¥0.5
		*/
		ans[i] = ans[data[i][1]] + 1 + (data[data[i][1]][0] - 1 - data[i][0]) * 0.5;
		printf(&#34; %.1f&#34;, ans[i]);
	}

	return 0;
}
</code></pre></main><div id=comments><hr><script src=//geoip-js.com/js/apis/geoip2/v2.1/geoip2.js type=text/javascript></script><script>var onSuccess=function(e){var t=e.country.names["zh-CN"],n=e.country.iso_code;if(!n)return;t&&(document.getElementById("comments-blocked-country-code").innerHTML=t),n=="CN"&&(document.getElementById("comments-shown").style.display="none",document.getElementById("comments-blocked").style.display="")},onError=function(){};geoip2.country(onSuccess,onError)</script><div id=comments-blocked style=font-style:italic;color:#777;display:none>è¯„è®ºåŒºå·²å…³é—­ã€‚<span style=float:right>æ¥è‡ª <span id=comments-blocked-country-code>unknown</span> çš„è®¿å®¢
<span>&nbsp; - powered by: geoip-js.com</span></span></div><div id=comments-shown><script src=https://utteranc.es/client.js repo=KB5201314/KB5201314.github.io issue-term=pathname label='ğŸ’¬ comments ğŸ’¬' theme=github-light crossorigin=anonymous async></script></div></div><footer class=footer><hr>Â© imlk 2017 &ndash; 2023 | <a href=https://blog.imlk.top>imlk's blog</a> | <a href=https://github.com/KB5201314/>Github</a> | <a href=mailto:me@imlk.top>Email</a> | <a href=https://beian.miit.gov.cn/>äº¬ICPå¤‡2020042968å·-1</a></footer></body></html>