<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>SoK: Understanding the Prevailing Security Vulnerabilities in TrustZone-assisted TEE Systems è®ºæ–‡é˜…è¯» | imlk's blog</title>
<link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel=stylesheet></head><body><header class=header><a class=logo href=/>imlk's Blog</a><nav><ul class=menu><li><a href=/>ğŸ Home</a></li><li><a href=/about/>ğŸ‘‹About</a></li><li><a href=/archives/>ğŸ“œArchives</a></li><li><a href=/friends/>ğŸ”—Friends</a></li><li><a href=/dn42/>ğŸ•¸ï¸DN42</a></li><li><a href=/index.xml>ğŸ“¢Subscribe</a></li></ul></nav></header><hr><div class=article-meta><h1><span class=title>SoK: Understanding the Prevailing Security Vulnerabilities in TrustZone-assisted TEE Systems è®ºæ–‡é˜…è¯»</span></h1><span><span class=date>ğŸ“… 2022-05-03</span>
<span class=date>(æ›´æ–°äº2023-08-30)</span>
/
<span class=cats>ğŸ“š
<a href=https://blog.imlk.top/categories/tee/>TEE</a>
</span>/
<span class=tags>ğŸ·ï¸
<a href=https://blog.imlk.top/tags/trustzone/>#TrustZone</a>
<a href=https://blog.imlk.top/tags/security/>#Security</a>
<a href=https://blog.imlk.top/tags/reading/>#Reading</a></span></span><br></div><main class=post-content><ul><li><a href=https://www.cs.purdue.edu/homes/pfonseca/papers/sp2020-tees.pdf>PDF version</a></li></ul><p>è¿™æ˜¯ä¸€ç¯‡IEEE S&amp;P 2020çš„è®ºæ–‡ï¼Œè¿™ç¯‡æ–‡ç« ä¸­ï¼Œä½œè€…é€šè¿‡åˆ†æè¿‡å»å‡ å¹´å†…TrustZoneçš„TEEæœ‰å…³çš„ä¸Šç™¾ä¸ªæ¼æ´ï¼Œåˆ†æå­˜åœ¨çš„å®‰å…¨é—®é¢˜ã€‚</p><ul><li><strong>åˆ—ä¸¾äº†å¾ˆå¤šæ¼æ´æˆå› </strong>ï¼Œéƒ¨åˆ†æ”»å‡»è¿˜ä¸¾ä¾‹äº†ç›¸å…³çš„å·¥ä½œã€‚</li><li><strong>åˆ—ä¸¾</strong>å‡ºäº†è¿‘å‡ å¹´çš„<strong>ä¸€äº›çš„é˜²å¾¡å·¥ä½œ</strong></li></ul><h1 id=æ€»è§ˆ>æ€»è§ˆ</h1><h2 id=åˆ†ææ–¹æ³•è®º>åˆ†ææ–¹æ³•è®º</h2><ul><li><p>æ”»å‡»çš„å¨èƒæ¨¡å‹ï¼šæå‡ºäº†4ä¸ªä¸åŒç¨‹åº¦çš„å¨èƒæ¨¡å‹ï¼Œè¡¨ç¤ºè¿™äº›æ¼æ´è‡´åŠ›äºå…¶ä¸­çš„ä¸€äº›ç›®æ ‡</p></li><li><p><strong>è¢«åˆ†æçš„TEEå®ç°ï¼š</strong> Qualcomm, Trustonic, Huawei, Nvidia, and Linaro.</p></li><li><p>æ¼æ´æ•°æ®æ¥æºï¼šCVE (CVE databases), SVE (SVE databases), SP (scientific publications), MR (miscellaneous reports), and SC (source code, for OP-TEE onlyï¼‰</p></li><li><p>æ¼æ´åˆ†çº§ï¼šè¡¨æ ¼åˆ—ä¸¾äº†å¯¹å·²è¢«åˆ†é…CVEçš„æ¼æ´çš„ä¸¥é‡ç­‰çº§åˆ†å¸ƒ</p></li><li><p>äºŒè¿›åˆ¶åˆ†æï¼š<strong>å¯¹TEEç³»ç»Ÿä¸­çš„å­é›†è¿›è¡ŒäºŒè¿›åˆ¶åˆ†æ</strong></p><ol><li>é‡åŒ–æ¯ä¸ªTEEç³»ç»Ÿçš„TCBèŒƒå›´</li><li>ç¡®å®šå…·ä½“çš„è½¯ä»¶æ¶æ„</li><li><strong>åˆ†ææ¯ä¸ªTEEå®ç°çš„å†…å­˜ä¿æŠ¤åŠŸèƒ½</strong></li></ol><p>å¯¹äºæ¯ä¸ªTEEç³»ç»Ÿåªé€†å‘åˆ†æäº†å…¶ä¸­çš„æŸä¸ªç‰ˆæœ¬</p></li><li><p>å¯¹ç»“è®ºçš„æœ‰æ•ˆæ€§çš„å¨èƒï¼šç”±äºç¼ºä¹POCå’ŒCVEæè¿°çš„ä¸å‡†ç¡®ï¼Œä½œè€…å¯¹æ¼æ´çš„åˆ†ç±»å¯èƒ½æ˜¯ä¸å‡†ç¡®çš„ã€‚</p></li></ul><h1 id=æ¼æ´åŸå› >æ¼æ´åŸå› </h1><h2 id=architectural-issue>architectural issue</h2><p>ä½œè€…åˆ—å‡ºäº†è°ƒç ”çš„TEEç³»ç»Ÿçš„ç»“æ„</p><p><img src=/images/%5BIEEE%20S&amp;P%202020%5DSoK%20Understanding%20the%20Prevailing%20Se%2015ffe15649f64bbcbfd22191f0c220ba/%E6%88%AA%E5%9B%BE_2022-05-03_16-38-58.png alt="æˆªå›¾ 2022-05-03 16-38-58.png"></p><h3 id=teeçš„æ”»å‡»é¢>TEEçš„æ”»å‡»é¢</h3><ul><li>T01. SW drivers run in the TEE kernel space<ul><li>å®‰å…¨ä¸–ç•Œä¸­çš„é©±åŠ¨å¯èƒ½æ˜¯è„†å¼±çš„ä½†æ˜¯å…·æœ‰è¾ƒé«˜çš„æƒé™çº§</li></ul></li><li>I02. Wide interfaces between TEE system subcomponents<ul><li>NWä¸­çš„kernelæš´éœ²äº†å¤ªå¤šçš„æ¥å£ç»™æ™®é€šç¨‹åº</li><li>SWä¸­çš„kernelç»™NWçš„kernelæš´éœ²äº†å¾ˆå¤šçš„SMCè°ƒç”¨</li><li>TAç»™CAæš´éœ²äº†å¾ˆå¤šcmd</li><li>SWä¸­çš„kernelç»™TAæš´éœ²äº†å¾ˆå¤šsyscallå¹¶ä¸”å¾ˆå°‘åšé™åˆ¶</li></ul></li><li>I03. Excessively large TEE TCBs<ul><li><p>TEEä¸–ç•Œä¸­çš„ä»£ç é‡å¾ˆå¤§ï¼Œä½œè€…ç”¨äº†ä¸€å¼ è¡¨æ ¼æ¥è¡¨ç¤º</p><p><img src=/images/%5BIEEE%20S&amp;P%202020%5DSoK%20Understanding%20the%20Prevailing%20Se%2015ffe15649f64bbcbfd22191f0c220ba/%E6%88%AA%E5%9B%BE_2022-05-03_16-54-54.png alt="æˆªå›¾ 2022-05-03 16-54-54.png"></p></li></ul></li></ul><h3 id=nwå’Œswä¹‹é—´çš„éš”ç¦»>NWå’ŒSWä¹‹é—´çš„éš”ç¦»</h3><ul><li>I04. TAs can map physical memory in the NW<ul><li>ç”±äºå¯¹é«˜æ•ˆçš„å…±äº«å†…å­˜æœºåˆ¶çš„éœ€æ±‚ï¼Œä¸€äº›TEE kernelå¦‚QSEEæä¾›ç³»ç»Ÿè°ƒç”¨è®©TAæ˜ å°„ä»»æ„çš„NWä¸­çš„å†…å­˜</li></ul></li><li>I05. Information leaks to NW through debugging channels<ul><li>ä¸€äº›å¯¹TAçš„è°ƒè¯•æœºåˆ¶å¦‚dump stack traceåˆ°NWï¼Œå°†logæä¾›ç»™NWèƒ½å¯¼è‡´åœ°å€ä¿¡æ¯æ³„éœ²</li></ul></li></ul><h3 id=å†…å­˜ä¿æŠ¤æœºåˆ¶>å†…å­˜ä¿æŠ¤æœºåˆ¶</h3><p><img src=/images/%5BIEEE%20S&amp;P%202020%5DSoK%20Understanding%20the%20Prevailing%20Se%2015ffe15649f64bbcbfd22191f0c220ba/Untitled.png alt=Untitled></p><ul><li>I06. Absent or weak <strong>ASLR</strong> implementations<ul><li>ASLRæœºåˆ¶å®æ–½ä¸å®Œå–„ï¼Œæœ‰äº›TEEä¸­TAè¢«åŠ è½½åˆ°å›ºå®šçš„ä½ç½®</li></ul></li><li>I07. No stack cookies, guard pages, or execution protection</li></ul><h3 id=å¯ä¿¡å¯åŠ¨>å¯ä¿¡å¯åŠ¨</h3><ul><li>I08. Lack of software-independent TEE integrity reporting<ul><li>å°½ç®¡å­˜åœ¨å®‰å…¨å¯åŠ¨ï¼Œä½†æ˜¯ç¼ºä¹å‘è¿œç¨‹ç¬¬ä¸‰æ–¹å®‰å…¨åœ°æŠ¥å‘Šè½¯ä»¶å®Œæ•´æ€§æµ‹é‡ç»“æœçš„ç¡¬ä»¶æœºåˆ¶</li></ul></li><li>I09. Ill-supported TA revocation<ul><li>æ— æ³•æ­£ç¡®åœ°å¤„ç†TAæ’¤é”€ï¼Œæ˜“å—åˆ°é™çº§æ”»å‡»</li></ul></li></ul><h2 id=implementation-issue>implementation issue</h2><h3 id=éªŒè¯é”™è¯¯validation-bugs>éªŒè¯é”™è¯¯Validation Bugs</h3><p>Examples include buffer overflows, incorrect parameter validation, mishandled integer overflows, etc.</p><ul><li>I10. Validation bugs within the secure monitor</li><li>I11. Validation bugs within TAs</li><li>I12. Validation bugs within the trusted kernel</li><li>I13. Validation bugs in secure boot loader</li></ul><h3 id=åŠŸèƒ½æ€§é”™è¯¯functional-bugs>åŠŸèƒ½æ€§é”™è¯¯Functional Bugs</h3><ul><li>I14. Bugs in memory protection</li><li>I15. Bugs in configuration of peripherals</li><li>I16. Bugs in security mechanisms</li></ul><h3 id=å¤–éƒ¨é”™è¯¯extrinsic-bugs>å¤–éƒ¨é”™è¯¯Extrinsic Bugs</h3><ul><li>I17. Concurrency bugs<ul><li>å¹¶å‘è®¿é—®æ–‡ä»¶ç³»ç»Ÿ(OP-TEE)</li><li>TOCTOUæ¼æ´ï¼Œç³»ç»ŸçŠ¶æ€çš„æŸäº›æ–¹é¢åœ¨æ¡ä»¶æ£€æŸ¥åå‘ç”Ÿå˜åŒ–ï¼ˆTrustonicã€Nvidiaï¼‰</li></ul></li><li>I18. Software side-channels</li></ul><h2 id=hardware-issue>hardware issue</h2><h3 id=æ¶æ„å½±å“architectural-implications>æ¶æ„å½±å“Architectural Implications</h3><ul><li>I19. Attacks through reconfigurable hardware components<ul><li>ä¸€äº›reconfigurableçš„å¹³å°å¦‚FPGAä¸Šç‰¹æœ‰çš„é—®é¢˜</li></ul></li><li>I20. Attacks through energy management mechanisms<ul><li>é€šè¿‡åœ¨NWä¾§è°ƒèŠ‚é¢‘ç‡å’Œç”µå‹åœ¨SWä¸­è¯±å‘é”™è¯¯çš„è®¡ç®—</li></ul></li></ul><h3 id=å¾®ä½“ç³»ç»“æ„ä¾§ä¿¡é“>å¾®ä½“ç³»ç»“æ„ä¾§ä¿¡é“</h3><ul><li>I21. Leaking information through caches</li><li>I22. Leaking information through branch predictor</li><li>I23. Leaking information using Rowhammer</li></ul><h1 id=é˜²å¾¡å·¥ä½œ>é˜²å¾¡å·¥ä½œ</h1><p><img src=/images/%5BIEEE%20S&amp;P%202020%5DSoK%20Understanding%20the%20Prevailing%20Se%2015ffe15649f64bbcbfd22191f0c220ba/%E6%88%AA%E5%9B%BE_2022-05-03_19-34-08.png alt="æˆªå›¾ 2022-05-03 19-34-08.png"></p><h2 id=ä½“ç³»ç»“æ„é˜²å¾¡architectural-defenses>ä½“ç³»ç»“æ„é˜²å¾¡Architectural Defenses</h2><ul><li>D01. Multi-isolated environments<ul><li>åœ¨NWä¸­åˆ›å»ºéš”ç¦»ç¯å¢ƒ<ul><li>åˆ©ç”¨TZASCï¼šSANCTUARYã€TrustICE</li><li>NWä¸­çš„ç¡¬ä»¶è™šæ‹ŸåŒ–æ‰©å±•ï¼šOSPã€PrivateZoneã€vTZ</li></ul></li><li>åŠ å¼ºSWä¸­TAçš„éš”ç¦»<ul><li>åœ¨SWä¸­å®ç°minimalist hypervisorï¼šTEEvã€PrOS<ul><li>å¹¶æœªä½¿ç”¨SWä¸­çš„ç¡¬ä»¶è™šæ‹ŸåŒ–æ”¯æŒ</li></ul></li></ul></li></ul></li><li>D02. Secure cross-world channels<ul><li>åˆ›å»ºå®‰å…¨çš„NW-SWé€šé“</li></ul></li><li>D03. Encrypted memory</li><li>D04. Trusted computing primitives</li></ul><h2 id=å®ç°ä¸Šçš„é˜²å¾¡implementation-defenses>å®ç°ä¸Šçš„é˜²å¾¡Implementation Defenses</h2><ul><li>D05. Managed code runtimes</li><li>D06. Type-safe programming languages<ul><li>RustZone</li></ul></li><li>D07. Software verification<ul><li>å¯¹ç‰¹å®šçš„ç»„ä»¶è¿›è¡Œå½¢å¼åŒ–éªŒè¯</li></ul></li></ul><h2 id=ç¡¬ä»¶é˜²å¾¡hardware-defenses>ç¡¬ä»¶é˜²å¾¡Hardware Defenses</h2><ul><li>D08. Architectural countermeasures</li><li>D09. Microarchitectural countermeasures</li></ul><h1 id=é™¤trustzoneä¹‹å¤–çš„å®‰å…¨ç¡¬ä»¶æŠ€æœ¯>é™¤TrustZoneä¹‹å¤–çš„å®‰å…¨ç¡¬ä»¶æŠ€æœ¯</h1><p><img src=/images/%5BIEEE%20S&amp;P%202020%5DSoK%20Understanding%20the%20Prevailing%20Se%2015ffe15649f64bbcbfd22191f0c220ba/%E6%88%AA%E5%9B%BE_2022-05-03_20-10-26.png alt="æˆªå›¾ 2022-05-03 20-10-26.png"></p></main><div id=comments><hr><script src=//geoip-js.com/js/apis/geoip2/v2.1/geoip2.js type=text/javascript></script><script>var onSuccess=function(e){var t=e.country.names["zh-CN"],n=e.country.iso_code;if(!n)return;t&&(document.getElementById("comments-blocked-country-code").innerHTML=t),n=="CN"&&(document.getElementById("comments-shown").style.display="none",document.getElementById("comments-blocked").style.display="")},onError=function(){};geoip2.country(onSuccess,onError)</script><div id=comments-blocked style=font-style:italic;color:#777;display:none>è¯„è®ºåŒºå·²å…³é—­ã€‚<span style=float:right>æ¥è‡ª <span id=comments-blocked-country-code>unknown</span> çš„è®¿å®¢
<span>&nbsp; - powered by: geoip-js.com</span></span></div><div id=comments-shown><script src=https://utteranc.es/client.js repo=KB5201314/KB5201314.github.io issue-term=pathname label='ğŸ’¬ comments ğŸ’¬' theme=github-light crossorigin=anonymous async></script></div></div><footer class=footer><hr>Â© imlk 2017 &ndash; 2023 | <a href=https://blog.imlk.top>imlk's blog</a> | <a href=https://github.com/KB5201314/>Github</a> | <a href=mailto:me@imlk.top>Email</a> | <a href=https://beian.miit.gov.cn/>äº¬ICPå¤‡2020042968å·-1</a></footer></body></html>