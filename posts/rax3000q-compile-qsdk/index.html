<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>ä»QSDKæºç ç¼–è¯‘RAX3000Qæ‰€éœ€çš„è½¯ä»¶åŒ… | imlk's blog</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel=stylesheet></head><body><header class=header><a class=logo href=/>imlk's Blog</a><nav><ul class=menu><li><a href=/>ğŸ Home</a></li><li><a href=/about/>ğŸ‘‹About</a></li><li><a href=/archives/>ğŸ“œArchives</a></li><li><a href=/friends/>ğŸ”—Friends</a></li><li><a href=/dn42/>ğŸ•¸ï¸DN42</a></li><li><a href=/index.xml>ğŸ“¢Subscribe</a></li></ul></nav></header><hr><div class=article-meta><h1><span class=title>ä»QSDKæºç ç¼–è¯‘RAX3000Qæ‰€éœ€çš„è½¯ä»¶åŒ…</span></h1><span><span class=date>2022-02-10</span>
<span class=date>(æ›´æ–°äº2022-07-19)</span>
/
<span class=cats><a href=https://blog.imlk.top/categories/router/>Router</a></span>
/
<span class=tags><a href=https://blog.imlk.top/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/>#è·¯ç”±å™¨</a>
<a href=https://blog.imlk.top/tags/openwrt/>#OpenWrt</a></span></span><br></div><main><blockquote><p><strong>NOTE: ä½œè€…å·²å¼ƒå‘ï¼Œæœ¬æ–‡ç›®å‰ä»…ä½œä¸ºç¼–è¯‘QSDKçš„å‚è€ƒ</strong></p></blockquote><blockquote><p>åŸå…ˆçš„è®¡åˆ’æ˜¯å°†QSDKä¸­æºå¸¦çš„è½¯ä»¶åŒ…ç¼–è¯‘æˆ.ipkæ–‡ä»¶ä¾›å¤§å®¶ä½¿ç”¨ï¼Œä½†QSDKæœ¬èº«å¸¦çš„ç¼–è¯‘è„šæœ¬ã€è½¯ä»¶åŒ…ç‰ˆæœ¬è¿‡äºè€æ—§ï¼Œç¼–è¯‘è¿‡ç¨‹ä¸­å®¹æ˜“å‡ºç°å„ç§å¥‡æ€ªé—®é¢˜ã€‚å¯¹å‡ºé”™çš„è½¯ä»¶åŒ…è¿›è¡Œä¿®å¤ï¼ˆåŒ…æ‹¬ä»OpenWRTçš„æºç ä¸­è¿ç§»ã€é›†æˆå›½å†…çš„ä¸€äº›feedï¼‰å·²è€—è´¹è¾ƒå¤šç²¾åŠ›ï¼Œä½†ä»æœ‰è®¸å¤šä¾èµ–çš„è½¯ä»¶åŒ…æœªå¤„ç†ã€‚é‰´äºè¿™äº›å·¥ä½œå’Œè¯¥è®¾å¤‡æœ¬èº«æ— ä»»ä½•å…³è”ï¼Œçº¯ç²¹çš„patch+rebuildä½“åŠ›æ´»åŠ¨ï¼Œä¸”æ—§çš„è½¯ä»¶åŒ…å› ç¼ºå°‘åŠŸèƒ½ã€å…¼å®¹æ€§é—®é¢˜ã€å­˜åœ¨æ¼æ´éšæ‚£ç­‰æ— å¤ªå¤§çš„ä½¿ç”¨æ„ä¹‰ã€‚ä¸å»ºè®®ç»§ç»­åšè¿™ç§å¾’åŠ³çš„äº‹æƒ…ã€‚æ„Ÿå…´è¶£çš„ç©å®¶å¯ä»¥è€ƒè™‘åœ¨ç°æœ‰çš„OpenWRTåˆ†æ”¯ä¸Šè¿ç§»å¢åŠ ipq5018æ”¯æŒã€‚</p></blockquote><p>å‰ä¸€ç¯‡æ–‡ç« ä¸­è®²åˆ°äº†å¦‚ä½•å¼€å¯RAX3000Qçš„sshï¼Œå¹¶ä¸”å‘ç°å…¶å›ºä»¶æ­£æ˜¯QSDKï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å¦¥å–„è§£å†³è½¯ä»¶åŒ…çš„é—®é¢˜ï¼Œè¿™ä¸€æ¬¡æˆ‘ä»¬å°è¯•åŸºäºQSDKæºç ç¼–è¯‘æˆ‘ä»¬æƒ³è¦çš„è½¯ä»¶åŒ…çš„ipkæ–‡ä»¶ã€‚</p><p>å®è·µè¿‡ç¨‹ä¹Ÿæ˜¯å‚è€ƒäº†å¾ˆå¤šç½‘ä¸Šçš„å…³äºQSDKçš„æ–‡ç« ã€‚</p><h1 id=å‡†å¤‡ç¯å¢ƒ>å‡†å¤‡ç¯å¢ƒ</h1><p>æˆ‘æ˜¯åœ¨dockerå®¹å™¨ä¸­æ„å»ºçš„ï¼Œç¯å¢ƒæ˜¯Ubuntu 20.04 ï¼ˆdockerhubä¸Šçš„<code>ubuntu:latest</code>ï¼‰ï¼Œå¯¹äºå…¶ä»–å‘è¡Œç‰ˆå¦‚ArchLinuxï¼Œåœ¨ç¼–è¯‘æ—¶å¯èƒ½éœ€è¦è§£å†³å®¿ä¸»æœºä¸Šopensslå¤´æ–‡ä»¶ç‰ˆæœ¬çš„é—®é¢˜ï¼Œä¸”æœ¬æ–‡ä¸­æåˆ°çš„patchå¯èƒ½ä¸å†é€‚ç”¨ã€‚</p><p>å¼€å§‹ä¹‹å‰ï¼Œè¿˜éœ€è¦å®‰è£…æ„å»ºæ‰€éœ€çš„å·¥å…·ï¼Œå¯ä»¥å‚è€ƒ<a href=https://openwrt.org/docs/guide-developer/toolchain/install-buildsystem#debianubuntu>OpenWrt - Build system setup</a></p><p>å¯¹äºubuntuï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo apt install build-essential ccache ecj fastjar file g++ gawk <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>gettext git java-propose-classpath libelf-dev libncurses5-dev <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>libncursesw5-dev libssl-dev python python2.7-dev python3 unzip wget <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>python3-distutils python3-setuptools python3-dev rsync subversion <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>swig time xsltproc zlib1g-dev 
</span></span></code></pre></div><h1 id=è·å–æºç >è·å–æºç </h1><p>QSDKçš„æºç ç®¡ç†ç±»ä¼¼äºAndroidå’ŒChromeOSï¼Œä¹ŸåŸºäº<a href=https://gerrit.googlesource.com/git-repo/+/HEAD/README.md><code>repo</code>å·¥å…·</a>ï¼Œåœ¨å¼€å§‹ä¹‹å‰éœ€è¦å…ˆå®‰è£…å¥½<code>repo</code>ã€‚</p><p>QSDKçš„manifestæ–‡ä»¶å­˜æ”¾åœ¨<a href=https://source.codeaurora.org/quic/cc-qrdk/releases/manifest/qstak/>è¿™ä¸ªä»“åº“</a>ä¸­ï¼Œåªæœ‰ä¸€ä¸ªåä¸º<code>release</code>çš„branchã€‚åœ¨ä¹‹å‰çš„åˆ†æä¸­çŸ¥é“è¯¥è·¯ç”±å™¨Openwrtç‰ˆæœ¬ä¸º15.05å’Œkernelç‰ˆæœ¬ä¸º4.4ï¼Œç»“åˆ<a href=https://wiki.codeaurora.org/xwiki/bin/viewrev/QSDK/WebHome>QSDKçš„wiki</a>ï¼Œæˆ‘é€‰æ‹©äº†ä¸»ç‰ˆæœ¬å·ä¸º11çš„QSDKçš„æœ€æ–°çš„manifestæ–‡ä»¶ï¼š<code>caf_AU_LINUX_QSDK_NHSS.QSDK.11.5.0.6_TARGET_ALL.11.5.0.6.055.xml</code>ã€‚</p><p>ä½¿ç”¨å¦‚ä¸‹è¯­å¥è·å–æºç å¹¶åˆå§‹åŒ–</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>repo init -u git://source.codeaurora.org/quic/cc-qrdk/releases/manifest/qstak -b release -m caf_AU_LINUX_QSDK_NHSS.QSDK.11.5.0.6_TARGET_ALL.11.5.0.6.055.xml
</span></span><span style=display:flex><span>repo sync
</span></span></code></pre></div><blockquote><p>è¯·å‹¿é€‰æ‹©<code>caf_AU_LINUX_QSDK_NHSS.QSDK.12.0.R9_TARGET_ALL.12.0.09.841.011.xml</code>ï¼Œæµ‹è¯•å‘ç°å…¶ä¸­çš„linuxç‰ˆæœ¬ä¸º5.4ï¼Œä¸”musl-libcç‰ˆæœ¬ä¸å½“å‰å›ºä»¶ä¸­çš„ä¸ç¬¦ã€‚</p></blockquote><p>å› ä¸ºç¼–è¯‘ç¯å¢ƒçš„é—®é¢˜ï¼Œç¼–è¯‘è¿‡ç¨‹ä¸­ï¼ˆå°¤å…¶æ˜¯æ„å»ºtoolchainæ—¶ï¼‰ä¼šå¯¼è‡´å¾ˆå¤šerroräº§ç”Ÿï¼Œåœ¨å¼€å§‹ä¹‹å‰éœ€è¦å¯¹æºç è¿›è¡Œä¸€äº›ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹å¤šæ•°æ˜¯å¢åŠ ä¸€äº›.patchæ–‡ä»¶ï¼Œæˆ–è€…æ˜¯å¯¹Makefileçš„ä¸€äº›æ”¹åŠ¨ã€‚</p><blockquote><p>å…¶ä¸­å¤§éƒ¨åˆ†æ”¹åŠ¨å‚è€ƒäº†<a href=https://www.litreily.top/2021/02/07/qsdk-compile>è¿™ç¯‡æ–‡ç« </a>ï¼Œååˆ†æ„Ÿè°¢è¿™ä½ä½œè€…ã€‚</p></blockquote><p>æ‰€æœ‰çš„ä¿®æ”¹å…±æ¶‰åŠ<code>qsdk/</code>å’Œ<code>qsdk/qca/feeds/packages/</code>è¿™ä¸¤ä¸ªç›®å½•ï¼Œå¯¹åº”çš„diffå¦‚ä¸‹</p><ul><li><p>qsdk/</p><details><summary>Click to extend</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git a/toolchain/gcc/patches/5.2.0/999-fix-too-many-template-parameters.patch b/toolchain/gcc/patches/5.2.0/999-fix-too-many-template-parameters.patch
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 000000000000..cab030714d2b
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/toolchain/gcc/patches/5.2.0/999-fix-too-many-template-parameters.patch
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,94 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+From 94801184df727b94bf7b8d64b1f98a22f51325d7 Mon Sep 17 00:00:00 2001
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+From: Elliot Saba &lt;staticfloat@gmail.com&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+Date: Mon, 22 Apr 2019 19:58:09 -0400
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+Subject: [PATCH] Remove double `tempate &lt;&gt;` declarations in `wide-int.h`
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+This fixes compilation of GCC 5.2.0 with very recent compilers such as
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+GCC 8.3.0, which would otherwise fail with errors such as `error: too
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+many template-parameter-lists`
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+---
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ gcc/wide-int.h | 10 ----------
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 1 file changed, 10 deletions(-)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+diff --git a/gcc/wide-int.h b/gcc/wide-int.h
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+index 46f45453c015..9a71c4fea61b 100644
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/gcc/wide-int.h
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/gcc/wide-int.h
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -365,21 +365,18 @@ namespace wi
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      inputs.  Note that CONST_PRECISION and VAR_PRECISION cannot be
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      mixed, in order to give stronger type checking.  When both inputs
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      are CONST_PRECISION, they must have the same precision.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  template &lt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   template &lt;typename T1, typename T2&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   struct binary_traits &lt;T1, T2, FLEXIBLE_PRECISION, FLEXIBLE_PRECISION&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+     typedef widest_int result_type;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   };
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  template &lt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   template &lt;typename T1, typename T2&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   struct binary_traits &lt;T1, T2, FLEXIBLE_PRECISION, VAR_PRECISION&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+     typedef wide_int result_type;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   };
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  template &lt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   template &lt;typename T1, typename T2&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   struct binary_traits &lt;T1, T2, FLEXIBLE_PRECISION, CONST_PRECISION&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -389,14 +386,12 @@ namespace wi
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 			       &lt;int_traits &lt;T2&gt;::precision&gt; &gt; result_type;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   };
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  template &lt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   template &lt;typename T1, typename T2&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   struct binary_traits &lt;T1, T2, VAR_PRECISION, FLEXIBLE_PRECISION&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+     typedef wide_int result_type;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   };
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  template &lt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   template &lt;typename T1, typename T2&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   struct binary_traits &lt;T1, T2, CONST_PRECISION, FLEXIBLE_PRECISION&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -406,7 +401,6 @@ namespace wi
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 			       &lt;int_traits &lt;T1&gt;::precision&gt; &gt; result_type;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   };
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  template &lt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   template &lt;typename T1, typename T2&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   struct binary_traits &lt;T1, T2, CONST_PRECISION, CONST_PRECISION&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -417,7 +411,6 @@ namespace wi
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 			       &lt;int_traits &lt;T1&gt;::precision&gt; &gt; result_type;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   };
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  template &lt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   template &lt;typename T1, typename T2&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   struct binary_traits &lt;T1, T2, VAR_PRECISION, VAR_PRECISION&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -881,7 +874,6 @@ generic_wide_int &lt;storage&gt;::dump () const
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ namespace wi
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  template &lt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   template &lt;typename storage&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   struct int_traits &lt; generic_wide_int &lt;storage&gt; &gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+     : public wi::int_traits &lt;storage&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -960,7 +952,6 @@ inline wide_int_ref_storage &lt;SE&gt;::wide_int_ref_storage (const T &amp;x,
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ namespace wi
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  template &lt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   template &lt;bool SE&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   struct int_traits &lt;wide_int_ref_storage &lt;SE&gt; &gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -1147,7 +1138,6 @@ class GTY(()) fixed_wide_int_storage
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ namespace wi
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  template &lt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   template &lt;int N&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   struct int_traits &lt; fixed_wide_int_storage &lt;N&gt; &gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>diff --git a/tools/bison/patches/001-fix-port-gnulib.patch b/tools/bison/patches/001-fix-port-gnulib.patch
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 000000000000..499d73a2666d
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/tools/bison/patches/001-fix-port-gnulib.patch
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,11 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+--- a/lib/fseterr.c  2022-02-10 13:17:52.129083732 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/lib/fseterr.c  2022-02-10 13:23:49.408599169 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -29,7 +29,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   /* Most systems provide FILE as a struct and the necessary bitmask in
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      &lt;stdio.h&gt;, because they need it for implementing getc() and putc() as
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      fast macros.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   fp-&gt;_flags |= _IO_ERR_SEEN;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #elif defined __sferror || defined __DragonFly__ /* FreeBSD, NetBSD, OpenBSD, DragonFly, Mac OS X, Cygwin */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   fp_-&gt;_flags |= __SERR;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>diff --git a/tools/e2fsprogs/patches/001-fix-undefined-reference-makedev.patch b/tools/e2fsprogs/patches/001-fix-undefined-reference-makedev.patch
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 000000000000..2c059b4ea072
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/tools/e2fsprogs/patches/001-fix-undefined-reference-makedev.patch
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,9 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+--- a/lib/blkid/devname.c 2021-02-07 16:04:24.190214251 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/lib/blkid/devname.c 2021-02-07 16:03:53.869128549 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -37,6 +37,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;sys/mkdev.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #endif
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;time.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#include &lt;sys/sysmacros.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &#34;blkidP.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>\ No newline at end of file
</span></span><span style=display:flex><span>diff --git a/tools/findutils/patches/001-fix-port-gnulib.patch b/tools/findutils/patches/001-fix-port-gnulib.patch
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 000000000000..f164d776ba24
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/tools/findutils/patches/001-fix-port-gnulib.patch
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,33 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+--- a/gnulib/lib/freadahead.c    2008-04-17 01:55:14.000000000 +0200
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/gnulib/lib/freadahead.c    2008-04-17 01:54:36.000000000 +0200
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -22,7 +22,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ size_t
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ freadahead (FILE *fp)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if defined _IO_ferror_unlocked     /* GNU libc, BeOS */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if defined _IO_EOF_SEEN || defined _IO_ferror_unlocked || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+     return 0;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   return (fp-&gt;_IO_read_end - fp-&gt;_IO_read_ptr)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/gnulib/lib/freading.c      2008-04-17 01:55:14.000000000 +0200
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/gnulib/lib/freading.c      2008-04-17 01:54:36.000000000 +0200
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -29,7 +29,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   /* Most systems provide FILE as a struct and the necessary bitmask in
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      &lt;stdio.h&gt;, because they need it for implementing getc() and putc() as
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      fast macros.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if defined _IO_ferror_unlocked     /* GNU libc, BeOS */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if defined _IO_EOF_SEEN || defined _IO_ferror_unlocked || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   return ((fp-&gt;_flags &amp; _IO_NO_WRITES) != 0
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+          || ((fp-&gt;_flags &amp; (_IO_NO_READS | _IO_CURRENTLY_PUTTING)) == 0
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+              &amp;&amp; fp-&gt;_IO_read_base != NULL));
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/gnulib/lib/fseeko.c        2008-04-17 01:55:14.000000000 +0200
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/gnulib/lib/fseeko.c        2008-04-17 01:54:36.000000000 +0200
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -39,7 +39,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #endif
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   /* These tests are based on fpurge.c.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if defined _IO_ferror_unlocked     /* GNU libc, BeOS */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if defined _IO_EOF_SEEN || defined _IO_ferror_unlocked || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (fp-&gt;_IO_read_end == fp-&gt;_IO_read_ptr
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+       &amp;&amp; fp-&gt;_IO_write_ptr == fp-&gt;_IO_write_base
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+       &amp;&amp; fp-&gt;_IO_save_base == NULL)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>diff --git a/tools/m4/patches/200-fix-port-gnulib-freadahead.patch b/tools/m4/patches/200-fix-port-gnulib-freadahead.patch
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 000000000000..9501b4fc7788
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/tools/m4/patches/200-fix-port-gnulib-freadahead.patch
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,109 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+diff --git a/lib/fflush.c b/lib/fflush.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+index 983ade0ffb..a6edfa105b 100644
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/lib/fflush.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/lib/fflush.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -33,7 +33,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #undef fflush
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ /* Clear the stream&#39;s ungetc buffer, preserving the value of ftello (fp).  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ static void
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -72,7 +72,7 @@ clear_ungetc_buffer (FILE *fp)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #endif
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if ! (defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if ! (defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ # if (defined __sferror || defined __DragonFly__ || defined __ANDROID__) &amp;&amp; defined __SNPT
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ /* FreeBSD, NetBSD, OpenBSD, DragonFly, Mac OS X, Cygwin, Minix 3, Android */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -148,7 +148,7 @@ rpl_fflush (FILE *stream)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (stream == NULL || ! freading (stream))
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+     return fflush (stream);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   clear_ungetc_buffer_preserving_position (stream);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+diff --git a/lib/fpurge.c b/lib/fpurge.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+index b1d417c7a2..3aedcc3734 100644
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/lib/fpurge.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/lib/fpurge.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -62,7 +62,7 @@ fpurge (FILE *fp)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   /* Most systems provide FILE as a struct and the necessary bitmask in
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      &lt;stdio.h&gt;, because they need it for implementing getc() and putc() as
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      fast macros.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-# if defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++# if defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   fp-&gt;_IO_read_end = fp-&gt;_IO_read_ptr;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   fp-&gt;_IO_write_ptr = fp-&gt;_IO_write_base;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   /* Avoid memory leak when there is an active ungetc buffer.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+diff --git a/lib/freadahead.c b/lib/freadahead.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+index c2ecb5b28a..23ec76ee53 100644
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/lib/freadahead.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/lib/freadahead.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -30,7 +30,7 @@ extern size_t __sreadahead (FILE *);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ size_t
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ freadahead (FILE *fp)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+     return 0;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   return (fp-&gt;_IO_read_end - fp-&gt;_IO_read_ptr)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+diff --git a/lib/freading.c b/lib/freading.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+index 73c28acddf..c24d0c88ab 100644
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/lib/freading.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/lib/freading.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -31,7 +31,7 @@ freading (FILE *fp)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   /* Most systems provide FILE as a struct and the necessary bitmask in
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      &lt;stdio.h&gt;, because they need it for implementing getc() and putc() as
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      fast macros.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-# if defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++# if defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   return ((fp-&gt;_flags &amp; _IO_NO_WRITES) != 0
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+           || ((fp-&gt;_flags &amp; (_IO_NO_READS | _IO_CURRENTLY_PUTTING)) == 0
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+               &amp;&amp; fp-&gt;_IO_read_base != NULL));
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+diff --git a/lib/fseeko.c b/lib/fseeko.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+index 0101ab55f7..193f4e8ce5 100644
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/lib/fseeko.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/lib/fseeko.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -47,7 +47,7 @@ fseeko (FILE *fp, off_t offset, int whence)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #endif
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   /* These tests are based on fpurge.c.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (fp-&gt;_IO_read_end == fp-&gt;_IO_read_ptr
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+       &amp;&amp; fp-&gt;_IO_write_ptr == fp-&gt;_IO_write_base
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+       &amp;&amp; fp-&gt;_IO_save_base == NULL)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -123,7 +123,7 @@ fseeko (FILE *fp, off_t offset, int whence)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+           return -1;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+         }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+       fp-&gt;_flags &amp;= ~_IO_EOF_SEEN;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+       fp-&gt;_offset = pos;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #elif defined __sferror || defined __DragonFly__ || defined __ANDROID__
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+diff --git a/lib/stdio-impl.h b/lib/stdio-impl.h
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+index 78d896e9f5..05c5752a24 100644
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/lib/stdio-impl.h
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/lib/stdio-impl.h
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -18,6 +18,12 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    the same implementation of stdio extension API, except that some fields
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+    have different naming conventions, or their access requires some casts.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++/* Glibc 2.28 made _IO_IN_BACKUP private.  For now, work around this
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++   problem by defining it ourselves.  FIXME: Do not rely on glibc
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++   internals.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if !defined _IO_IN_BACKUP &amp;&amp; defined _IO_EOF_SEEN
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++# define _IO_IN_BACKUP 0x100
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#endif
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ /* BSD stdio derived implementations.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>diff --git a/tools/make-ext4fs/patches/001-fix-undefined-reference-major-minor.patch b/tools/make-ext4fs/patches/001-fix-undefined-reference-major-minor.patch
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 000000000000..8ee8929c1416
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/tools/make-ext4fs/patches/001-fix-undefined-reference-major-minor.patch
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,9 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+--- a/contents.c        2021-02-07 15:37:31.463251930 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/contents.c        2021-02-07 15:37:03.022743240 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -15,6 +15,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;sys/stat.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#include &lt;sys/sysmacros.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;string.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;stdio.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>\ No newline at end of file
</span></span><span style=display:flex><span>diff --git a/tools/mtd-utils/patches/001-fix-missing-header-file-sys-sysmacros.patch b/tools/mtd-utils/patches/001-fix-missing-header-file-sys-sysmacros.patch
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 000000000000..d3e586803835
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/tools/mtd-utils/patches/001-fix-missing-header-file-sys-sysmacros.patch
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,10 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+--- a/include/common.h  2021-02-07 16:25:50.643801767 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/include/common.h  2021-02-07 16:25:41.139803836 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -19,6 +19,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #ifndef __MTD_UTILS_COMMON_H__
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #define __MTD_UTILS_COMMON_H__
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#include &lt;sys/sysmacros.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;stdbool.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;stdio.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;stdlib.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>\ No newline at end of file
</span></span><span style=display:flex><span>diff --git a/tools/sed/patches/001-fix-port-gnulib.patch b/tools/sed/patches/001-fix-port-gnulib.patch
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 000000000000..a3fd8709482f
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/tools/sed/patches/001-fix-port-gnulib.patch
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,11 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+--- a/lib/fwriting.c     2012-09-13 14:58:19.000000000 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/lib/fwriting.c     2022-02-10 13:28:31.221698961 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -27,7 +27,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   /* Most systems provide FILE as a struct and the necessary bitmask in
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      &lt;stdio.h&gt;, because they need it for implementing getc() and putc() as
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+      fast macros.  */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-#if defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#if defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   return (fp-&gt;_flags &amp; (_IO_NO_READS | _IO_CURRENTLY_PUTTING)) != 0;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #elif defined __sferror || defined __DragonFly__ /* FreeBSD, NetBSD, OpenBSD, DragonFly, Mac OS X, Cygwin */
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   return (fp_-&gt;_flags &amp; __SWR) != 0;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>diff --git a/tools/squashfs4/Makefile b/tools/squashfs4/Makefile
</span></span><span style=display:flex><span>index 50b70fbe1c90..fe292de0960b 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/tools/squashfs4/Makefile
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/tools/squashfs4/Makefile
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -24,7 +24,7 @@ define Host/Compile
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 		XZ_SUPPORT=1 \
</span></span><span style=display:flex><span> 		LZMA_XZ_SUPPORT=1 \
</span></span><span style=display:flex><span> 		XATTR_SUPPORT= \
</span></span><span style=display:flex><span><span style=color:#f92672>-		LZMA_LIB=&#34;$(STAGING_DIR_HOST)/lib/liblzma.a&#34; \
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+		LZMA_LIB=&#34;$(STAGING_DIR_HOST)/lib/liblzma.a -lmd&#34; \
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> 		EXTRA_CFLAGS=&#34;-I$(STAGING_DIR_HOST)/include&#34; \
</span></span><span style=display:flex><span> 		mksquashfs unsquashfs
</span></span><span style=display:flex><span> endef
</span></span><span style=display:flex><span>diff --git a/tools/squashfs4/patches/001-fix-undefined-reference-major.patch b/tools/squashfs4/patches/001-fix-undefined-reference-major.patch
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 000000000000..89b065d95bff
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/tools/squashfs4/patches/001-fix-undefined-reference-major.patch
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,20 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+--- a/squashfs-tools/mksquashfs.c       2021-02-08 10:08:42.135709202 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/squashfs-tools/mksquashfs.c       2021-02-08 10:09:03.263649419 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -52,6 +52,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;regex.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;fnmatch.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;sys/wait.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#include &lt;sys/sysmacros.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #ifndef linux
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #ifndef __CYGWIN__
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/squashfs-tools/unsquashfs.c       2021-02-08 10:08:48.335691509 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/squashfs-tools/unsquashfs.c       2021-02-08 10:09:24.919589603 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -30,6 +30,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &#34;xattr.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #include &lt;sys/types.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++#include &lt;sys/sysmacros.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ struct cache *fragment_cache, *data_cache;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ struct queue *to_reader, *to_deflate, *to_writer, *from_writer;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>\ No newline at end of file
</span></span></code></pre></div></details></li><li><p>qsdk/qca/feeds/packages/</p><details><summary>Click to extend</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git a/libs/libgpg-error/patches/020-gawk5-support.patch b/libs/libgpg-error/patches/020-gawk5-support.patch
</span></span><span style=display:flex><span>new file mode 100644
</span></span><span style=display:flex><span>index 0000000000..218d097498
</span></span><span style=display:flex><span><span style=color:#f92672>--- /dev/null
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/libs/libgpg-error/patches/020-gawk5-support.patch
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -0,0 +1,124 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>+--- a/lang/cl/mkerrcodes.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/lang/cl/mkerrcodes.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -122,7 +122,7 @@ header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ !header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  sub (/\#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++  sub (/#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   sub (/[ 	]+$/, &#34;&#34;); # Strip trailing space and tab characters.
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (/^$/)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/src/Makefile.am
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/src/Makefile.am
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -293,7 +293,7 @@ code-from-errno.h: mkerrcodes$(EXEEXT_FOR_BUILD) Makefile
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ errnos-sym.h: Makefile mkstrtable.awk errnos.in
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 	$(AWK) -f $(srcdir)/mkstrtable.awk -v textidx=2 -v nogettext=1 \
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-		-v prefix=GPG_ERR_ -v namespace=errnos_ \
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++		-v prefix=GPG_ERR_ -v pkg_namespace=errnos_ \
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 		$(srcdir)/errnos.in &gt;$@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/src/Makefile.in	2022-02-10 19:51:36.848145191 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/src/Makefile.in	2022-02-10 20:04:18.368259432 +0800
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -1018,7 +1018,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ errnos-sym.h: Makefile mkstrtable.awk errnos.in
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 	$(AWK) -f $(srcdir)/mkstrtable.awk -v textidx=2 -v nogettext=1 \
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-		-v prefix=GPG_ERR_ -v namespace=errnos_ \
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++		-v prefix=GPG_ERR_ -v pkg_namespace=errnos_ \
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 		$(srcdir)/errnos.in &gt;$@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ # We depend on versioninfo.rc because that is build by config.status
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/src/mkerrcodes.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/src/mkerrcodes.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -85,7 +85,7 @@ header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ !header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  sub (/\#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++  sub (/#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   sub (/[ 	]+$/, &#34;&#34;); # Strip trailing space and tab characters.
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (/^$/)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/src/mkerrcodes1.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/src/mkerrcodes1.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -81,7 +81,7 @@ header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ !header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  sub (/\#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++  sub (/#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   sub (/[ 	]+$/, &#34;&#34;); # Strip trailing space and tab characters.
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (/^$/)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/src/mkerrcodes2.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/src/mkerrcodes2.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -91,7 +91,7 @@ header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ !header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  sub (/\#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++  sub (/#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   sub (/[ 	]+$/, &#34;&#34;); # Strip trailing space and tab characters.
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (/^$/)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/src/mkerrnos.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/src/mkerrnos.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -83,7 +83,7 @@ header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ !header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  sub (/\#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++  sub (/#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   sub (/[ 	]+$/, &#34;&#34;); # Strip trailing space and tab characters.
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (/^$/)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+--- a/src/mkstrtable.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++++ b/src/mkstrtable.awk
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -77,7 +77,7 @@
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ # The variable prefix can be used to prepend a string to each message.
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ #
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-# The variable namespace can be used to prepend a string to each
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++# The variable pkg_namespace can be used to prepend a string to each
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ # variable and macro name.
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ BEGIN {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -102,7 +102,7 @@ header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+       print &#34;/* The purpose of this complex string table is to produce&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+       print &#34;   optimal code with a minimum of relocations.  */&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+       print &#34;&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-      print &#34;static const char &#34; namespace &#34;msgstr[] = &#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++      print &#34;static const char &#34; pkg_namespace &#34;msgstr[] = &#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+       header = 0;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+     }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   else
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -110,7 +110,7 @@ header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ }
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ !header {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  sub (/\#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++  sub (/#.+/, &#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   sub (/[ 	]+$/, &#34;&#34;); # Strip trailing space and tab characters.
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   if (/^$/)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -150,7 +150,7 @@ END {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   else
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+     print &#34;  gettext_noop (\&#34;&#34; last_msgstr &#34;\&#34;);&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   print &#34;&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  print &#34;static const int &#34; namespace &#34;msgidx[] =&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++  print &#34;static const int &#34; pkg_namespace &#34;msgidx[] =&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   print &#34;  {&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   for (i = 0; i &lt; coded_msgs; i++)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+     print &#34;    &#34; pos[i] &#34;,&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+@@ -158,7 +158,7 @@ END {
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   print &#34;  };&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   print &#34;&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   print &#34;static GPG_ERR_INLINE int&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+-  print namespace &#34;msgidxof (int code)&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>++  print pkg_namespace &#34;msgidxof (int code)&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   print &#34;{&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+   print &#34;  return (0 ? 0&#34;;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ 
</span></span></span></code></pre></div></details></li></ul><h1 id=ç¼–è¯‘>ç¼–è¯‘</h1><h2 id=ç¼–è¯‘å‰çš„å‡†å¤‡>ç¼–è¯‘å‰çš„å‡†å¤‡</h2><p>é¦–å…ˆè¿›å…¥qsdkæºç ç›®å½•ï¼Œå…¶ä¸­çš„ç›®å½•å¸ƒå±€å’Œopenwrtéå¸¸æ¥è¿‘</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cd qsdk
</span></span></code></pre></div><p>åœ¨é…ç½®ä¹‹å‰å°†feedsä¸­çš„è½¯ä»¶åŒ…æ·»åŠ è¿›æ¥ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>./scripts/feeds update -a
</span></span><span style=display:flex><span>./scripts/feeds install -a
</span></span><span style=display:flex><span>make package/symlinks
</span></span></code></pre></div><p>å®é™…ä¸Šæ˜¯æ ¹æ®feeds.confæ›´æ–°feedsï¼Œç„¶ååœ¨<code>./packages/feeds/</code>ç›®å½•é‡Œé¢åˆ›å»ºåˆ°<code>./feeds/*</code>ä¸­çš„feedsåŒ…çš„è½¯é“¾æ¥ï¼Œåœ¨è¿™ä¸€æ­¥ä¹‹åæ‰èƒ½çœ‹è§æ›´å¤šçš„è½¯ä»¶åŒ…</p><h2 id=é…ç½®qsdk>é…ç½®QSDK</h2><p>ä½¿ç”¨é»˜è®¤çš„é…ç½®ä½œä¸º<code>.config</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cp qca/configs/qsdk/ipq_open.config .config
</span></span></code></pre></div><p>æ¥ç€ä½¿ç”¨èœå•é…ç½®ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>make menuconfig
</span></span></code></pre></div><p>RAX3000Qè‡ªå¸¦çš„å›ºä»¶æ˜¯32bitçš„ï¼Œå› æ­¤æˆ‘ä»¬è¿™é‡Œ<code>target</code>é€‰<code>IPQ</code>ï¼Œ<code>subtarget</code>é€‰<code>IPQ50xx(32bit)</code>ï¼Œåœ¨<code>Boot Loaders</code>é‡Œé¢æŠŠipq50xxä¹‹å¤–çš„å…¶å®ƒå…¶å®ƒèŠ¯ç‰‡ç»„çš„å…¨éƒ¨å–æ¶ˆé€‰ä¸­ã€‚</p><p>æ¥ç€ç›´æ¥ä¿å­˜ä¸º<code>.config</code>ã€‚</p><p>åœ¨ç°æœ‰çš„<code>.config</code>ä¸­æ·»åŠ é»˜è®¤é…ç½®ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>make defconfig
</span></span></code></pre></div><p>æ¥ç€å¯ä»¥è¿›è¡Œä¸€äº›ä¸ªæ€§åŒ–é…ç½®ï¼Œæˆ–è€…å¤‡ä»½å¯¹.configæ–‡ä»¶æ‰€ä½œçš„ä¿®æ”¹ï¼Œæˆ‘ç›´æ¥è·³è¿‡äº†ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>make kernel_menuconfig <span style=color:#75715e># é…ç½®å†…æ ¸ï¼Œå¯é€‰</span>
</span></span><span style=display:flex><span>make menuconfig <span style=color:#75715e># å†æ¬¡é…ç½®ï¼Œå¯é€‰</span>
</span></span><span style=display:flex><span>scripts/diffconfig.sh &gt; mydiffconfig <span style=color:#75715e># å¤‡ä»½ä¿®æ”¹åˆ°æ–‡ä»¶mydiffconfigï¼Œå¯é€‰</span>
</span></span></code></pre></div><h2 id=ç¼–è¯‘-1>ç¼–è¯‘</h2><ul><li><p>é¢„ä¸‹è½½æºç </p><p>ä¸ºäº†æé«˜ç¼–è¯‘æ•ˆç‡ï¼Œå…ˆä¸‹è½½æ‰€æœ‰ä¾èµ–ï¼Œå¹¶æ¿€æ´»å¤šçº¿ç¨‹ç¼–è¯‘ï¼ˆOpenwrtå®˜ç½‘è¿™ä¹ˆè¯´çš„ï¼Œä¹Ÿä¸çŸ¥é“å¯¹å¤šçº¿ç¨‹åˆ°åº•æœ‰æ²¡æœ‰å½±å“ï¼‰</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>make download
</span></span></code></pre></div><ul><li>downloadé˜¶æ®µæ³¨æ„ï¼š<ul><li>ç¦ç”¨luci-app-storeï¼šMakefileé‡Œçš„å†…å®¹å¤ªæ–°äº†ï¼Œä¸é€‚åˆæ—§ç‰ˆæœ¬çš„openwrtï¼ˆæ‡’å¾—æ”¹äº†</li><li>ç¦ç”¨nssæ¨¡å—ï¼Œ<a href=https://www.right.com.cn/forum/thread-5454564-1-1.html>å› ä¸º</a><ul><li>è¿™é‡Œç¦ç”¨QTI software > Network Devicesé‡Œé¢çš„<code>qca-nss-fw-mp-enterprise</code> å’Œ<code>qca-nss-fw-mp-retail</code></li></ul></li><li>lua-bencodeä½œè€…è·‘è·¯ï¼Œæ”¹ç”¨<a href=https://bitbucket-archive.softwareheritage.org/new-static/cd/cd306d52-db1e-420b-adf1-58dae40a70f3/attachments/>è¿™é‡Œ</a>çš„tar.gzæ–‡ä»¶</li><li>ä¸‹è½½vpncåŒ…æ—¶ï¼Œé‡åˆ°<code>svn: E230001: Server SSL certificate verification failed: issuer is not trusted</code><ul><li>è§£å†³æ–¹æ³•ï¼šè¿è¡Œ<code>svn ls https://svn.unix-ag.uni-kl.de/vpnc/trunk</code>ï¼Œä¼šè¯¢é—®ä½ æ˜¯å¦ä¿¡ä»»è¯¥è¯ä¹¦ï¼Œé€‰æ‹©<code>(p)ermanently</code>æ°¸è¿œè®°ä½ã€‚</li><li>å¦‚æœæ˜¯<code>curl: (60) SSL certificate problem: unable to get local issuer certificate</code><ul><li>åˆ™æ˜¯å› ä¸ºç½‘ç«™é…ç½®é”™è¯¯ï¼Œç³»ç»Ÿç¼ºå°‘æ ¹è¯ä¹¦ï¼Œubuntuä¸Šçš„è§£å†³æ–¹æ³•æ˜¯ï¼š</li><li>æ‰§è¡Œ<code>openssl s_client -connect svn.unix-ag.uni-kl.de:443 -CApath /etc/ssl/certs</code>è·å¾—ç½‘ç«™çš„è¯ä¹¦ï¼Œæ‹·è´ä»<code>-----BEGIN CERTIFICATE-----</code>åˆ°<code>-----END CERTIFICATE-----</code>çš„å†…å®¹ï¼ˆåŒ…å«ï¼‰æ”¾åˆ°<code>/usr/local/share/ca-certificates/</code>é‡Œçš„ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶é‡Œï¼Œéšä¾¿åå­—ï¼Œä»¥<code>.crt</code>ç»“å°¾å³å¯ã€‚</li><li>æ‰§è¡Œ<code>update-ca-certificates</code></li><li>éšå<code>curl https://svn.unix-ag.uni-kl.de/vpnc/trunk/</code>å°±å˜å¾—æ­£å¸¸äº†</li></ul></li></ul></li><li>å–æ¶ˆbatmandåŒ…ï¼Œå› ä¸ºæºç ä»svnå˜æˆgitäº†ï¼Œå¤ªéº»çƒ¦<ul><li>æˆ–è€…ç…§<a href=https://github.com/openwrt/routing/blob/openwrt-21.02/batmand/Makefile>è¿™ä¸ª</a>æ”¹</li></ul></li></ul></li></ul></li><li><p>æ„å»ºtoolchain</p><p>æ­£å¼ç¼–è¯‘ä¹‹å‰è¦å…ˆç¼–è¯‘toolchainï¼Œè¿™ä¸€æ­¥ä¸­ä¼šå› ä¸ºç¼–è¯‘ç¯å¢ƒçš„é—®é¢˜å¯¼è‡´å¾ˆå¤šerroräº§ç”Ÿï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å…ˆæ‰“ä¸€äº›patchçš„</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>make toolchain/install -j V<span style=color:#f92672>=</span>s
</span></span></code></pre></div></li><li><p>é…ç½®è½¯ä»¶åŒ…</p><p>é€‰æ‹©æ„å»ºæ‰€æœ‰è½¯ä»¶åŒ…åŒ…æ‹¬kmodçš„ipkæ–‡ä»¶ï¼Œä½ éœ€è¦ç§»é™¤å½“å‰çš„.configæ–‡ä»¶å¹¶é‡æ–°ç”Ÿæˆå®ƒã€‚è¯·æ”¾å¿ƒï¼Œè¿™ä¸ä¼šå¯¼è‡´ä½ éœ€è¦é‡æ–°ç¼–è¯‘toolchainã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œåœ¨ä½ ç”¨æ–°çš„.configæ–‡ä»¶ç¬¬ä¸€æ¬¡è¿è¡Œ<code>make menuconfig</code>æ—¶ï¼Œå¢åŠ å¦‚ä¸‹æ“ä½œï¼š</p><p>åœ¨Global build settingsä¸‹é€‰ä¸­ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>[*] Select all kernel module packages by default
</span></span><span style=display:flex><span>[*] Select all userspace packages by default
</span></span></code></pre></div><p>ç„¶åä½ ä¼šå‘ç°ä½ çš„<code>.confg</code>é‡Œçš„<code>CONFIG_PACKAGE_xxxxxx</code>ä¹‹ç±»çš„é€‰é¡¹çš„å€¼å…¨éƒ¨ï¼ˆæˆ‘è¿™é‡Œæœ‰4150ä¸ªï¼‰å˜æˆäº†<code>m</code>ï¼Œè¿™è¯´æ˜é€‰ä¸­äº†æ‰€æœ‰çš„è½¯ä»¶åŒ…ã€‚</p><p>ç„¶åä½¿ç”¨<code>make defconfig</code>è¿½åŠ å‰©ä½™çš„é»˜è®¤é…ç½®</p></li><li><p>ç¼–è¯‘å†…æ ¸</p><p>åœ¨ç¼–è¯‘æ‰€æœ‰è½¯ä»¶åŒ…ä¹‹å‰ï¼Œä½ å¯èƒ½éœ€è¦æå‰ç¼–è¯‘å†…æ ¸ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>make target/linux/compile -j V<span style=color:#f92672>=</span>s <span style=color:#75715e># ç¼–è¯‘å†…æ ¸æºç å’Œkmod</span>
</span></span><span style=display:flex><span>make package/kernel/linux/compile -j V<span style=color:#f92672>=</span>s <span style=color:#75715e># æ‰“åŒ…</span>
</span></span><span style=display:flex><span>make package/kernel/linux/install -j V<span style=color:#f92672>=</span>s <span style=color:#75715e># å®‰è£…åˆ°bin/</span>
</span></span></code></pre></div><p>ç¼–è¯‘é˜¶æ®µ</p><ul><li>å¯ä»¥æ·»åŠ è¿™ä¸ªï¼Œä¸ç„¶ä¼šåœ¨ç¼–è¯‘å†…æ ¸æ—¶è¯¢é—®ä½ <ul><li><code># CONFIG_KERNEL_USB_CONFIGFS_F_UVC is not set</code></li></ul></li></ul><p>æ‰“åŒ…é˜¶æ®µ</p><ul><li><p><code>dma-shared-buffer.ko</code>é—®é¢˜</p><pre tabindex=0><code>ERROR: module &#39;/qsdk/qsdk/build_dir/target-arm_cortex-a7_musl-1.1.16_eabi/linux-ipq_ipq50xx/linux-4.4.60/drivers/dma-buf/dma-shared-buffer.ko&#39; is missing.
</code></pre><p>å…¶å®åœ¨ç¼–è¯‘å†…æ ¸çš„æ—¶å€™æœ‰è­¦å‘Šè¿‡<code>.config:1228:warning: symbol value 'm' invalid for DMA_SHARED_BUFFER</code></p><p>è¿™æ˜¯åœ¨æ‰“åŒ…<code>kmod-dma-buf</code>æ—¶å‡ºç°çš„ï¼Œæˆ‘ä»¬ç®€å•ç¦ç”¨è¿™ä¸ªåŒ…åŠä¾èµ–å®ƒçš„åŒ…</p><ul><li>kmod-video-core</li></ul></li><li><p>ç¦ç”¨ä»¥ä¸‹æ¨¡å—ï¼ŒåŸå› ç±»ä¼¼</p><ul><li>kmod-usb-dwc2</li><li>kmod-iio-core</li></ul></li><li><p>æ³¨æ„ä¼šæœ‰å¾ˆå¤šçš„<code>generating empty package</code>è­¦å‘Šï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…æ—¶æ£€æŸ¥ä»¥æ¸…é™¤è¿™äº›æ— ç”¨çš„åŒ…</p></li></ul></li><li><p>ç¼–è¯‘è½¯ä»¶åŒ…</p><pre tabindex=0><code>make package/compile -j3 V=s
</code></pre><ul><li><p>ç¦ç”¨ä»¥ä¸‹ç¼–è¯‘å¤±è´¥çš„åŒ…ï¼š</p><ul><li>ath10k-firmware-qca99x0</li><li>kmod-r8125</li><li>kmod-r8168</li><li>tcpping</li><li>quickstartï¼šæ²¡æœ‰armç‰ˆæœ¬æä¾›</li><li>bwm-ngï¼šundefined reference to `get_iface_stats'</li><li>pthsemï¼šä¸æ”¯æŒmusl<ul><li>åŠå…¶ä¾èµ–ï¼šknxdã€knxd-toolsã€linknx</li></ul></li><li>libnfcï¼šåŠå…¶ä¾èµ–nfc-utils</li><li>opencv</li><li>tgt</li><li>b43legacy-firmware</li><li>kmod-usb-gzero</li><li>perl-www-curl</li><li>kmod-usb-f_ss_lb</li><li>batman-advï¼šå·²æ›¿æ¢æˆ<a href=https://github.com/openwrt/routing/tree/lede-17.01/batman-adv>è¿™é‡Œçš„</a>æºç </li><li>coova-chilli</li><li>avrdude</li><li>alsa-pluginsç³»åˆ—ï¼š<ul><li>alsa-plugins-full</li><li>alsa-plugins-oss</li><li>alsa-plugins-speex</li></ul></li><li>aiccu</li><li>openswan</li><li>kmod-openswan</li><li>tcsh</li><li>amule<ul><li>luci-app-amule</li><li>antileech</li></ul></li><li>&mldr;</li></ul></li><li><p>æš‚æ—¶ç¦ç”¨çš„ï¼š</p><ul><li>luci-app-poweroffdevice</li><li>naiveproxy</li><li>snmpd-static</li></ul></li><li><p>æœ‰é—®é¢˜çš„ï¼š</p><ul><li><p>xinetdï¼š</p><pre tabindex=0><code>../../include/config.h:126:21: error: &#39;long long long&#39; is too long for GCC
 #define rlim_t long long
                     ^
</code></pre></li><li><p>zile</p></li><li><p>thc-ipv6</p></li><li><p>js-depsï¼šnpm: Command not found</p><pre tabindex=0><code>apt install npm
</code></pre></li><li><p>lua-maxminddbï¼š</p><pre tabindex=0><code>fatal error: maxminddb.h: No such file or directory
</code></pre><pre tabindex=0><code>apt install libmaxminddb-dev
</code></pre></li><li><p>mjpg-streamer</p></li><li><p>privoxy</p></li><li><p>flashrom</p></li></ul></li><li><p>ä¸ºäº†ç¼–è¯‘ä¸€äº›å¸¸è§è½¯ä»¶åŒ…ï¼ˆaliyun webdavä¹‹ç±»çš„ï¼‰ï¼Œéœ€è¦å¢å‡æ„å»ºä¸€ä¸ªå«<code>upx</code>çš„å·¥å…·</p><ul><li><p>åœ¨<code>tools/Makefile</code>æ·»åŠ </p><pre tabindex=0><code>tools-y += upx
</code></pre></li></ul></li><li><p>ç¼–è¯‘etherwakeå‡ºç°<code>error: redefinition of struct ethhdr</code></p><ul><li>å‚è€ƒ<a href=https://wiki.musl-libc.org/faq.html#Q:-Why-am-I-getting->musl-libcæ–‡æ¡£</a>ï¼Œè§£å†³åŠæ³•æ˜¯ç»™etherwakeæ‰“patchå»é™¤æ‰<code>#include &lt;linux/if_ether.h></code></li></ul></li></ul><p>æ¥ç€ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ç¼–è¯‘ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>make -j V<span style=color:#f92672>=</span>s IGNORE_ERRORS<span style=color:#f92672>=</span>m
</span></span></code></pre></div><p><code>IGNORE_ERRORS=m</code>çš„ä½œç”¨çš„è·³è¿‡æŸäº›ç¼–è¯‘é”™è¯¯çš„è½¯ä»¶åŒ…ã€‚åƒä¸‡ä¸è¦ä½¿ç”¨<code>-i</code>æ¥è·³è¿‡ï¼Œè¿™ä¼šä½¿å¾—æœ€ç»ˆçš„ipkæ–‡ä»¶ä¸­ç¼ºå°‘æ–‡ä»¶</p><p>ä»å®˜ç½‘å®‰è£…goè€Œéaptä¸Šçš„è€ç‰ˆæœ¬</p></li></ul><hr><ul><li><p>åªæ„å»ºç‰¹å®šè½¯ä»¶åŒ…</p><p>é¦–å…ˆéœ€è¦åœ¨make menuconfigä¸­å‹¾é€‰è¯¥è½¯ä»¶åŒ…ï¼Œä»¥<code>firewall</code>ä¸ºä¾‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>make package/network/config/firewall/compile V<span style=color:#f92672>=</span>s
</span></span></code></pre></div><p>äº§ç‰©åœ¨<code>./bin/ipq/packages/base/firewall_2015-07-27_ipq.ipk</code></p></li><li><p>å…¨ç›˜ç¼–è¯‘</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>make -j V<span style=color:#f92672>=</span>s
</span></span></code></pre></div><p>äº§ç”Ÿçš„å®Œæ•´imgæ–‡ä»¶åœ¨<code>./bin/ipq/</code>ä¸‹ã€‚</p><p>ä½†æ˜¯æˆ‘<strong>æ²¡æœ‰å°è¯•è¿‡å°†å…¶åˆ·å…¥</strong>å› æ­¤<strong>ä¸ä¿è¯ä¸ä¼šåˆ·åï¼ï¼ï¼ï¼ï¼ï¼</strong></p></li></ul><h1 id=ç¼–è¯‘å¤±è´¥çš„æ’é”™>ç¼–è¯‘å¤±è´¥çš„æ’é”™</h1><p><a href=https://www.litreily.top/2021/02/07/qsdk-compile>è¿™ç¯‡æ–‡ç« </a>é‡Œå·²ç»æ¶µç›–äº†å¾ˆå¤šåœ¨ubuntu20.04ç¯å¢ƒä¸­ç¼–è¯‘æ—¶å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼Œä½†æˆ‘åœ¨ç¼–è¯‘è¿™ä¸€ç‰ˆæœ¬çš„QSDKæ—¶è¿˜é‡åˆ°äº†é¢å¤–çš„é—®é¢˜ã€‚æ‰€æœ‰å¯¹QSDKæ‰€éœ€çš„ä¿®æ”¹å·²ç»åœ¨æ–‡ç« å¼€å¤´çš„diffæ–‡ä»¶ä¸­æ¶µç›–äº†ï¼Œè¿™é‡Œåªæ˜¯åˆ—å‡ºä¿¡æ¯æœ‰åŠ©äºæ’é”™ï¼š</p><ul><li><p>u-bootçš„ç¼–è¯‘ä¾èµ–äºlibssl1.0-devï¼š</p><p>ç³»ç»Ÿçš„libssl-devç‰ˆæœ¬å¤ªæ–°äº†ï¼Œéœ€è¦æ›´æ¢ä¸ºlibssl1.0-dev</p></li><li><p>ç¼–è¯‘squashfs4æ—¶é‡åˆ°undefined reference to `SHA256Init&rsquo;ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>/usr/bin/ld: /qsdk/qsdk/staging_dir/host/lib/liblzma.a(liblzma_la-check.o): in function `lzma_check_init&#39;:
</span></span><span style=display:flex><span>check.c:(.text+0x75): undefined reference to `SHA256Init&#39;
</span></span><span style=display:flex><span>/usr/bin/ld: /qsdk/qsdk/staging_dir/host/lib/liblzma.a(liblzma_la-check.o): in function `lzma_check_update&#39;:
</span></span><span style=display:flex><span>check.c:(.text+0xbf): undefined reference to `SHA256Update&#39;
</span></span><span style=display:flex><span>/usr/bin/ld: /qsdk/qsdk/staging_dir/host/lib/liblzma.a(liblzma_la-check.o): in function `lzma_check_finish&#39;:
</span></span><span style=display:flex><span>check.c:(.text+0x115): undefined reference to `SHA256Final&#39;
</span></span><span style=display:flex><span>collect2: error: ld returned 1 exit status
</span></span></code></pre></div><p>å‚è€ƒ<a href=https://forums.freebsd.org/threads/binutils-gdb-linker-wont-find-_libmd_sha256_init-etc.79347/>è¿™ä¸ªé“¾æ¥</a>å¯ä»¥äº†è§£åˆ°ï¼Œè¿™æ˜¯å› ä¸ºå®¿ä¸»ç¯å¢ƒä¸­æä¾›<code>SHA256Init</code>è¿™ä¸ªå‡½æ•°çš„åº“æ”¹ä¸ºäº†<code>libmd.a</code>ï¼Œéœ€è¦ä¿®æ”¹<code>tools/squashfs4/Makefile</code>ï¼ŒåŠ ä¸Šé“¾æ¥å™¨é€‰é¡¹<code>-lmd</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span><span style=color:#f92672>--- a/tools/squashfs4/Makefile
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/tools/squashfs4/Makefile
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -24,7 +24,7 @@ define Host/Compile
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 		XZ_SUPPORT=1 \
</span></span><span style=display:flex><span> 		LZMA_XZ_SUPPORT=1 \
</span></span><span style=display:flex><span> 		XATTR_SUPPORT= \
</span></span><span style=display:flex><span><span style=color:#f92672>-		LZMA_LIB=&#34;$(STAGING_DIR_HOST)/lib/liblzma.a&#34; \
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+		LZMA_LIB=&#34;$(STAGING_DIR_HOST)/lib/liblzma.a -lmd&#34; \
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span> 		EXTRA_CFLAGS=&#34;-I$(STAGING_DIR_HOST)/include&#34; \
</span></span><span style=display:flex><span> 		mksquashfs unsquashfs
</span></span><span style=display:flex><span> endef
</span></span></code></pre></div></li><li><p>ç¼–è¯‘gcc-5.2.0æ—¶æŠ¥<code>gcc-5.2.0/gcc/wide-int.h:370:10: error: too many template-parameter-lists</code></p><p>ä¿®å¤åŠæ³•å‚è€ƒ<a href=https://gist.github.com/thierer/534faf0772ee66c51fdfcf964ebb1655>è¿™é‡Œ</a></p></li><li><p>ç¼–è¯‘libgpg-erroræ—¶å‡ºç°gawkå’Œ<code>namespace</code>ç›¸å…³çš„é”™è¯¯ä¿¡æ¯</p><p>æ˜¯å› ä¸ºå®¿ä¸»æœºå™¨ä½¿ç”¨çš„gawk5.0ç‰ˆæœ¬è¿‡æ–°ï¼Œä¿®å¤æ–¹æ³•<a href=https://github.com/neheb/packages/blob/9afde0d39ae364c327063d36b188465058056a86/libs/libgpg-error/patches/020-gawk5-support.patch>å‚è€ƒè¿™ä¸ªpatch</a></p></li></ul><h1 id=å¼•ç”¨>å¼•ç”¨</h1><ul><li><p><a href=https://www.litreily.top/2021/01/29/qsdk/%5B>ä¸‹è½½å®‰è£…åŸºäº openwrt çš„ QSDK - LITREILY</a></p></li><li><p><a href=https://www.litreily.top/2021/02/07/qsdk-compile>åŸºäº IPQ807x ç¼–è¯‘ QSDK - LITREILY</a></p></li><li><p><a href=https://nodemand.hatenablog.com/entry/2020/11/24/155129>ä¸º SONY MANOMA NCP-HG100 æ„å»º Dropbearï¼ˆSSH æœåŠ¡å™¨ï¼‰</a></p></li></ul></main><div id=comments><hr><script src=https://utteranc.es/client.js repo=KB5201314/KB5201314.github.io issue-term=pathname label='ğŸ’¬ comments ğŸ’¬' theme=github-light crossorigin=anonymous async></script></div><footer><hr>Â© imlk 2017 &ndash; 2021 | <a href=https://blog.imlk.top>imlk's blog</a> | <a href=https://github.com/KB5201314/>Github</a> | <a href=mailto:me@imlk.top>Email</a> | <a href=https://beian.miit.gov.cn/>äº¬ICPå¤‡ - 2020042968å·</a></footer></body></html>