<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Android Studio免DDMS免configure快速调试Smali代码 | imlk's blog</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel=stylesheet></head><body><header class=header><a class=logo href=/>imlk's Blog</a><nav><ul class=menu><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/archives/>Archives</a></li><li><a href=/friends/>Friends</a></li><li><a href=/index.xml>Subscribe</a></li></ul></nav></header><hr><div class=article-meta><h1><span class=title>Android Studio免DDMS免configure快速调试Smali代码</span></h1><span><span class=date>2018-07-19</span>
<span class=date>(更新于2021-10-10)</span>
/
<span class=cats><a href=https://blog.imlk.top/categories/reverse/>Reverse</a></span>
/
<span class=tags><a href=https://blog.imlk.top/tags/android/>#Android</a>
<a href=https://blog.imlk.top/tags/debug/>#Debug</a>
<a href=https://blog.imlk.top/tags/ddms/>#DDMS</a></span></span><br></div><main><h3 id=起因>起因</h3><p>Android Studio是开发Android应用的一大利器，极大的提高了生产力（虽然比较臃肿），debug功能也非常好用，而且不止能debug Java代码，smali代码也能调试，配合apktool使用真的是爽的很（除了indexing花了老半天这个问题以外）。</p><p>但是！这个利器在<strong>调试smali工程的时候</strong>，就表现得十分不友好啦，以前有DDMS的时候还好一些，能看到调试端口号，但是经常遇到DDMS和AndroidStudio的adb端口冲突的问题，水火不容，无奈之下只能<code>adb shell am start -D -n xxx.xxxx.xxxx/.xxxx</code>手动以debug模式启动应用，配合<code>adb forward tcp:xxxx jdwp:xxxx</code>，但是不知道咋回事经常遇到</p><pre tabindex=0><code>Unable to open debugger port (localhost:8603): java.io.IOException &#34;handshake failed - connection prematurally closed&#34;
</code></pre><p>每次遇到这种错误，我心中是一万只草泥马飞奔而过啊！这tm还让不让人debug啦！</p><p><img src=/images/blog/49_0.png alt=WTF!></p><h3 id=冷静分析>冷静分析</h3><p>想起了Android Studio打开纯Android项目的时候，在顶部工具栏会有一个调试用的按钮<code>Attach debugger to Android process</code>,就是那个图标是竖着的长方形，右下角一只小虫子的按钮，点一下可以选择要attch的进程
<img src=/images/blog/49_1.png alt="Attach debugger to Android process"></p><p>这个功能在开发的时候用起来很爽，但是当我们打开的不是Android项目时：
<img src=/images/blog/49_2.png alt=WTF!></p><p>这个按钮没了
<img src=/images/blog/49_3.png alt="假的Android Studio吧"></p><h3 id=别着急>别着急</h3><p>这应该是Android Studio 设计的问题，它被设计成了只要不是Android项目就不显示那些按钮，但是它忽略了调试smali的情况</p><p>冷静，何必和一个小按钮过意不去呢，让我们来想想对策。</p><p>Run -> 没有
Help -> Find Action -> 搜不到</p><p>就在这山穷水复无路之际，突然想出个点子：</p><p><strong>快捷键！</strong>
<strong>快捷键！</strong>
<strong>快捷键！</strong></p><h3 id=解决办法是快捷键>解决办法是快捷键</h3><p><strong>Setting -> 搜索 -> Attach debugger to Android process -> keymap</strong></p><p><img src=/images/blog/49_4.png alt="真·Attach debugger to Android process"></p><p>不出所料真的搜到了，<strong>这里的快捷键是我添加的，原先没有快捷键</strong>，我设置的是<code>Ctrl + Alt + R</code>
R就是<code>reverse</code>嘛，+D的都被占了没办法。</p><p>确认，出来试试。</p><p>果然功夫不负有心人！</p><p><img src=/images/blog/49_5.png alt="真·Choose Process"></p><p>测试发现完全ok！</p><h3 id=ddms再见><del>DDMS，再见</del></h3><p>去你丫的DDMS，再见（丢）！
<img src=/images/blog/49_6.png alt=丢了></p><p>不行。。。</p><p><img src=/images/blog/49_7.png alt=捡起>
Android Studio 里还没有 Method Profiling 呢</p></main><div id=comments><hr><script src=https://utteranc.es/client.js repo=KB5201314/KB5201314.github.io issue-term=pathname label='💬 comments 💬' theme=github-light crossorigin=anonymous async></script></div><footer><hr>© imlk 2017 &ndash; 2021 | <a href=https://blog.imlk.top>imlk's blog</a> | <a href=https://github.com/KB5201314/>Github</a> | <a href=mailto:me@imlk.top>Email</a> | <a href=https://beian.miit.gov.cn/>京ICP备 - 2020042968号</a></footer></body></html>