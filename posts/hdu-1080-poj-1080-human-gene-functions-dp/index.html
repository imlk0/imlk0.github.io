<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>HDU 1080 POJ 1080 Human Gene Functionsâ€”â€”åŠ¨æ€è§„åˆ’ | imlk's blog</title>
<link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel=stylesheet></head><body><header class=header><a class=logo href=/>imlk's Blog</a><nav><ul class=menu><li><a href=/>ğŸ Home</a></li><li><a href=/about/>ğŸ‘‹About</a></li><li><a href=/archives/>ğŸ“œArchives</a></li><li><a href=/friends/>ğŸ”—Friends</a></li><li><a href=/dn42/>ğŸ•¸ï¸DN42</a></li><li><a href=/index.xml>ğŸ“¢Subscribe</a></li></ul></nav></header><hr><div class=article-meta><h1><span class=title>HDU 1080 POJ 1080 Human Gene Functionsâ€”â€”åŠ¨æ€è§„åˆ’</span></h1><span><span class=date>ğŸ“… 2018-02-26</span>
<span class=date>(æ›´æ–°äº2021-10-10)</span>
/
<span class=cats>ğŸ“š
<a href=https://blog.imlk.top/categories/algorithm/>Algorithm</a>
</span>/
<span class=tags>ğŸ·ï¸
<a href=https://blog.imlk.top/tags/poj/>#POJ</a></span></span><br></div><main class=post-content><p><a href="http://poj.org/problem?id=1080">http://poj.org/problem?id=1080</a>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1080">http://acm.hdu.edu.cn/showproblem.php?pid=1080</a></p><pre tabindex=0><code>#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;map&gt;
#include &lt;cstring&gt;

#define MAX(x,y,z) ((x)&gt;(y)?((x)&gt;(z)?(x):(z)):((y)&gt;(z)?(y):(z)))

using namespace std;

char str1[105];
char str2[105];
int list[6][6] = {
//	  		{ \0,  A,  C,  G,  T,  -}
	/*\0*/	{  0,  0,  0,  0,  0,  0},
	/*A*/	{  0,  5, -1, -2, -1, -3},
	/*C*/	{  0, -1,  5, -3, -2, -4},
	/*G*/	{  0, -2, -3,  5, -2, -2},
	/*T*/	{  0, -1, -2, -2,  5, -1},
	/*-*/	{  0, -3, -4, -2, -1,  0},
};
map&lt;char, int&gt;m;

int dp[105][105];//dp[x][y]è¡¨ç¤ºstr1ä¸­1...x-1ä¸ªå­—ç¬¦å’Œstr2ä¸­ç¬¬1...y-1ä¹‹é—´åŒ¹é…çš„æœ€ä¼˜è§£

int main(int argc, char const *argv[])
{
	int T, len1, len2;
	scanf(&#34;%d&#34;, &amp;T);

	m[&#39;\0&#39;] = 0;
	m[&#39;A&#39;] = 1;
	m[&#39;C&#39;] = 2;
	m[&#39;G&#39;] = 3;
	m[&#39;T&#39;] = 4;
	m[&#39;-&#39;] = 5;

	while (T--) {
		memset(dp, 0, sizeof(dp));
		scanf(&#34;%d%s&#34;, &amp;len1, str1 + 1);
		scanf(&#34;%d%s&#34;, &amp;len2, str2 + 1);

		// printf(&#34;\t\t&#34;);
		// for (int y = 0; y &lt; len2; y++) {
		// 	printf(&#34;%c\t&#34;, s2[y]);
		// }
		// printf(&#34;\n\t&#34;);

		// for (int y = 0; y &lt;= len2; y++) {
		// 	printf(&#34;%d\t&#34;, dp[0][y]);

		// }
		// printf(&#34;\n&#34;);

		for (int x = 1; x &lt;= len1 + 1; x++) {
			dp[x][0] = -1e9;
		}

		for (int y = 1; y &lt;= len2 + 1; y++) {
			dp[0][y] = -1e9;
		}

		for (int x = 1; x &lt;= len1 + 1; x++) {

			for (int y = 1; y &lt;= len2 + 1; y++) {
				dp[x][y] = MAX(
				               dp[x - 1][y - 1] + list[m[str1[x - 1]]][m[str2[y - 1]]],
				               dp[x - 1][y] + list[m[str1[x - 1]]][m[&#39;-&#39;]],
				               dp[x][y - 1] + list[m[&#39;-&#39;]][m[str2[y - 1]]]
				           );

//å–æ¶ˆæ³¨é‡‹æ‰“å°æµç¨‹

/*				if (dp[x - 1][y - 1] + list[m[str1[x - 1]]][m[str2[y - 1]]]
				        &gt;= dp[x - 1][y] + list[m[str1[x - 1]]][m[&#39;-&#39;]]) {
					if (dp[x - 1][y - 1] + list[m[str1[x - 1]]][m[str2[y - 1]]]
					        &gt;=
					        dp[x][y - 1] + list[m[&#39;-&#39;]][m[str2[y - 1]]]) {
						printf(&#34;â†–%d\t&#34;, dp[x][y]);
					} else {
						printf(&#34;â†%d\t&#34;, dp[x][y]);
					}
				} else {
					if (dp[x - 1][y] + list[m[str1[x - 1]]][m[&#39;-&#39;]]
					        &gt;=
					        dp[x][y - 1] + list[m[&#39;-&#39;]][m[str2[y - 1]]]) {
						printf(&#34;â†‘%d\t&#34;, dp[x][y]);
					} else {
						printf(&#34;â†%d\t&#34;, dp[x][y]);

					}
				}
*/

			}

/*
			printf(&#34;\n&#34;);
*/

		}
		printf(&#34;%d\n&#34;, dp[len1 + 1][len2 + 1]);

		/**
		*
		*	in:
		*	
		*	2
		*	7 AGTGATG
		*	5 GTTAG
		*	7 AGCTATT
		*	9 AGCTTTAAA
		*	
		*	out:
		*	
		*	â†–0		â†-2		â†-3		â†-4		â†-7		â†-9
		*	â†‘-3		â†–-2		â†–-3		â†–-4		â†–1		â†-1
		*	â†‘-5		â†–2		â†1		â†0		â†‘-1		â†–6
		*	â†‘-6		â†‘1		â†–7		â†–6		â†3		â†‘5
		*	â†‘-8		â†–-1		â†‘5		â†–5		â†–4		â†–8
		*	â†‘-11	â†‘-4		â†‘2		â†–4		â†–10		â†8
		*	â†‘-12	â†‘-5		â†–1		â†–7		â†‘9		â†–8
		*	â†‘-14	â†–-7		â†‘-1		â†‘5		â†‘7		â†–14
		*	
		*	14
		*	
		*	â†–0		â†-3		â†-5		â†-9		â†-10	â†-11	â†-12	â†-15	â†-18	â†-21
		*	â†‘-3		â†–5		â†3		â†-1		â†-2		â†-3		â†-4		â†–-7		â†–-10	â†–-13
		*	â†‘-5		â†‘3		â†–10		â†6		â†5		â†4		â†3		â†0		â†-3		â†-6
		*	â†‘-9		â†‘-1		â†‘6		â†–15		â†14		â†13		â†12		â†9		â†6		â†3
		*	â†‘-10	â†‘-2		â†‘5		â†‘14		â†–20		â†–19		â†–18		â†15		â†12		â†9
		*	â†‘-13	â†–-5		â†‘2		â†‘11		â†‘17		â†–19		â†–18		â†–23		â†–20		â†–17
		*	â†‘-14	â†‘-6		â†‘1		â†‘10		â†–16		â†–22		â†–24		â†‘22		â†–22		â†–19
		*	â†‘-15	â†‘-7		â†‘0		â†‘9		â†–15		â†–21		â†–27		â†24		â†–21		â†–21
		*	
		*	
		*	21
		*	
		*	
		*	
		*/

	}
	return 0;
}
</code></pre><p>åæ¥å‘ç°æ˜¯è‡ªå·±æƒ³å¾—å¤ªå¤šäº†ï¼Œè¿™ä¸ªé¢˜çš„â€œçŠ¶æ€â€ä¸ä¸€å®šéè¦ç†è§£æˆåŸå…ˆé‚£æ ·ï¼Œ
å…¶å®å®Œå…¨å¯ä»¥ä¹Ÿåƒæœ€å¤§å…¬å…±å­åˆ—é‚£æ ·çš„ï¼Œ
dp[x][y]è¡¨ç¤ºstr1çš„å‰xä¸ªå­—ç¬¦å’Œstr2çš„å‰yä¸ªå­—ç¬¦ä¹‹é—´çš„åŒ¹é…ç»“æœçš„æœ€ä¼˜è§£
è¿™æ ·ä¹Ÿä¾¿äºç†è§£ï¼Œä¾¿äºæ€è€ƒ</p><p>è¿™æ ·çš„è¯dp[x][y]å°±æ˜¯æœ€ç»ˆç­”æ¡ˆï¼Œä¸è¿‡è¦æ³¨æ„è¾¹ç•Œçš„é¢„å¤„ç†
ä»£ç å¦‚ä¸‹</p><pre tabindex=0><code>#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;map&gt;
#include &lt;cstring&gt;

#define MAX(x,y,z) ((x)&gt;(y)?((x)&gt;(z)?(x):(z)):((y)&gt;(z)?(y):(z)))

using namespace std;

char str1[105];
char str2[105];
int list[6][6] = {
//	  		{  A,  C,  G,  T,  -}
	/*A*/	{  5, -1, -2, -1, -3},
	/*C*/	{ -1,  5, -3, -2, -4},
	/*G*/	{ -2, -3,  5, -2, -2},
	/*T*/	{ -1, -2, -2,  5, -1},
	/*-*/	{ -3, -4, -2, -1,  0},
};

map&lt;char, int&gt;m;

int dp[105][105];//dp[x][y]è¡¨ç¤ºstr1ä¸­1...xä¸ªå­—ç¬¦å’Œstr2ä¸­ç¬¬1...yè¿™ä¸¤ä¸ªå­ä¸²ä¹‹é—´çš„æ‰€æœ‰åŒ¹é…æ–¹å¼çš„æœ€å¤§åˆ©ç›Š

int main(int argc, char const *argv[])
{
	int T, len1, len2;
	scanf(&#34;%d&#34;, &amp;T);

	m[&#39;A&#39;] = 0;
	m[&#39;C&#39;] = 1;
	m[&#39;G&#39;] = 2;
	m[&#39;T&#39;] = 3;
	m[&#39;-&#39;] = 4;

	while (T--) {
		memset(dp, 0, sizeof(dp));
		scanf(&#34;%d%s&#34;, &amp;len1, str1 + 1);
		scanf(&#34;%d%s&#34;, &amp;len2, str2 + 1);

		// printf(&#34;\t\t&#34;);
		// for (int y = 0; y &lt; len2; y++) {
		// 	printf(&#34;%c\t&#34;, s2[y]);
		// }
		// printf(&#34;\n\t&#34;);

		// for (int y = 0; y &lt;= len2; y++) {
		// 	printf(&#34;%d\t&#34;, dp[0][y]);

		// }
		// printf(&#34;\n&#34;);

		for (int x = 1; x &lt;= len1; x++) {
			dp[x][0] = dp[x - 1][0] + list[m[str1[x]]][m[&#39;-&#39;]];
		}

		// printf(&#34;â†–0\t&#34;);
		for (int y = 1; y &lt;= len2; y++) {
			dp[0][y] = dp[0][y - 1] + list[m[str2[y]]][m[&#39;-&#39;]];
			// printf(&#34;â†%d\t&#34;, dp[0][y]);
		}
		// printf(&#34;\n&#34;);

		for (int x = 1; x &lt;= len1; x++) {

			// printf(&#34;â†‘%d\t&#34;, dp[x][0]);

			for (int y = 1; y &lt;= len2; y++) {
				dp[x][y] = MAX(
				               dp[x - 1][y - 1] + list[m[str1[x]]][m[str2[y]]],
				               dp[x - 1][y] + list[m[str1[x]]][m[&#39;-&#39;]],
				               dp[x][y - 1] + list[m[&#39;-&#39;]][m[str2[y]]]
				           );

//å–æ¶ˆæ‰€æœ‰é¢å¤–æ³¨é‡Šå¯æ‰“å°æµç¨‹
				/*
								if (dp[x - 1][y - 1] + list[m[str1[x]]][m[str2[y]]]
								        &gt;= dp[x - 1][y] + list[m[str1[x]]][m[&#39;-&#39;]]) {
									if (dp[x - 1][y - 1] + list[m[str1[x]]][m[str2[y]]]
									        &gt;=
									        dp[x][y - 1] + list[m[&#39;-&#39;]][m[str2[y]]]) {
										printf(&#34;â†–%d\t&#34;, dp[x][y]);
									} else {
										printf(&#34;â†%d\t&#34;, dp[x][y]);
									}
								} else {
									if (dp[x - 1][y] + list[m[str1[x]]][m[&#39;-&#39;]]
									        &gt;=
									        dp[x][y - 1] + list[m[&#39;-&#39;]][m[str2[y]]]) {
										printf(&#34;â†‘%d\t&#34;, dp[x][y]);
									} else {
										printf(&#34;â†%d\t&#34;, dp[x][y]);

									}
								}
				*/

			}

			/*
						printf(&#34;\n&#34;);
			*/

		}
		printf(&#34;%d\n&#34;, dp[len1][len2]);

		/**
		*
		*	in:
		*
		*	2
		*	7 AGTGATG
		*	5 GTTAG
		*	7 AGCTATT
		*	9 AGCTTTAAA
		*
		*	out:
		*
		*	â†–0		â†-2		â†-3		â†-4		â†-7		â†-9
		*	â†‘-3		â†–-2		â†–-3		â†–-4		â†–1		â†-1
		*	â†‘-5		â†–2		â†1		â†0		â†‘-1		â†–6
		*	â†‘-6		â†‘1		â†–7		â†–6		â†3		â†‘5
		*	â†‘-8		â†–-1		â†‘5		â†–5		â†–4		â†–8
		*	â†‘-11	â†‘-4		â†‘2		â†–4		â†–10		â†8
		*	â†‘-12	â†‘-5		â†–1		â†–7		â†‘9		â†–8
		*	â†‘-14	â†–-7		â†‘-1		â†‘5		â†‘7		â†–14
		*
		*	14
		*
		*	â†–0		â†-3		â†-5		â†-9		â†-10	â†-11	â†-12	â†-15	â†-18	â†-21
		*	â†‘-3		â†–5		â†3		â†-1		â†-2		â†-3		â†-4		â†–-7		â†–-10	â†–-13
		*	â†‘-5		â†‘3		â†–10		â†6		â†5		â†4		â†3		â†0		â†-3		â†-6
		*	â†‘-9		â†‘-1		â†‘6		â†–15		â†14		â†13		â†12		â†9		â†6		â†3
		*	â†‘-10	â†‘-2		â†‘5		â†‘14		â†–20		â†–19		â†–18		â†15		â†12		â†9
		*	â†‘-13	â†–-5		â†‘2		â†‘11		â†‘17		â†–19		â†–18		â†–23		â†–20		â†–17
		*	â†‘-14	â†‘-6		â†‘1		â†‘10		â†–16		â†–22		â†–24		â†‘22		â†–22		â†–19
		*	â†‘-15	â†‘-7		â†‘0		â†‘9		â†–15		â†–21		â†–27		â†24		â†–21		â†–21
		*
		*
		*	21
		*
		*
		*
		*/

	}
	return 0;
}
</code></pre></main><div id=comments><hr><script src=//geoip-js.com/js/apis/geoip2/v2.1/geoip2.js type=text/javascript></script><script>var onSuccess=function(e){var t=e.country.names["zh-CN"],n=e.country.iso_code;if(!n)return;t&&(document.getElementById("comments-blocked-country-code").innerHTML=t),n=="CN"&&(document.getElementById("comments-shown").style.display="none",document.getElementById("comments-blocked").style.display="")},onError=function(){};geoip2.country(onSuccess,onError)</script><div id=comments-blocked style=font-style:italic;color:#777;display:none>è¯„è®ºåŒºå·²å…³é—­ã€‚<span style=float:right>æ¥è‡ª <span id=comments-blocked-country-code>unknown</span> çš„è®¿å®¢
<span>&nbsp; - powered by: geoip-js.com</span></span></div><div id=comments-shown><script src=https://utteranc.es/client.js repo=imlk0/imlk0.github.io issue-term=pathname label='ğŸ’¬ comments ğŸ’¬' theme=github-light crossorigin=anonymous async></script></div></div><footer class=footer><hr>Â© imlk 2017 &ndash; 2023 | <a href=https://blog.imlk.top>imlk's blog</a> | <a href=https://github.com/imlk0/>Github</a> | <a href=mailto:me@imlk.top>Email</a> | <a href=https://beian.miit.gov.cn/>äº¬ICPå¤‡2020042968å·-1</a></footer></body></html>